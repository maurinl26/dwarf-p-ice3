<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Rain ice parameters - dwarf-ice3-gt4py</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Rain ice parameters";
        var mkdocs_page_input_path = "ice3/phyex_common/rain_ice_parameters.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> dwarf-ice3-gt4py
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../translation_options/">Translation Notes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../namelists/">Namelists</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">drivers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../drivers/cli/">Cli</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../drivers/core/">Core</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ice3</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >components</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../components/ice4_tendencies/">Ice4 tendencies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../components/ice_adjust/">Ice adjust</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../components/ice_adjust_modular/">Ice adjust modular</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../components/rain_ice/">Rain ice</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >functions</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/backup/">Backup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/compute_ice_fraction/">Compute ice fraction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/gamma/">Gamma</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/ice_adjust/">Ice adjust</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/icecloud/">Icecloud</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/interp_micro/">Interp micro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/sign/">Sign</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/temperature/">Temperature</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/tiwmx/">Tiwmx</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../functions/upwind_sedimentation/">Upwind sedimentation</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../initialisation/state_ice4_tendencies/">State ice4 tendencies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../initialisation/state_ice_adjust/">State ice adjust</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../initialisation/state_rain_ice/">State rain ice</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >phyex_common</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../constants/">Constants</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ice_parameters/">Ice parameters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../incomplete_gamma/">Incomplete gamma</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../lookup_table/">Lookup table</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../namparar/">Namparar</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../nebn/">Nebn</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../phyex/">Phyex</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../phyex_dimensions/">Phyex dimensions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../rain_ice_descriptors/">Rain ice descriptors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../rain_ice_field_address/">Rain ice field address</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Rain ice parameters</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../xker_raccs/">Xker raccs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../xker_rdryg/">Xker rdryg</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../xker_sdryg/">Xker sdryg</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >stencils</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_compute_pdf/">Ice4 compute pdf</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_correct_negativities/">Ice4 correct negativities</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_fast_rg/">Ice4 fast rg</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_fast_ri/">Ice4 fast ri</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_fast_rs/">Ice4 fast rs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_nucleation/">Ice4 nucleation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_rimltc/">Ice4 rimltc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_rrhong/">Ice4 rrhong</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_slow/">Ice4 slow</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_stepping/">Ice4 stepping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_tendencies/">Ice4 tendencies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice4_warm/">Ice4 warm</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/ice_adjust/">Ice adjust</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../stencils/rain_ice_nucleation.md">None</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/cloud_fraction/">Cloud fraction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/condensation/">Condensation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/precipitation_fraction_liquid_content/">Precipitation fraction liquid content</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/rain_ice/">Rain ice</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../stencils/sedimentation/">Sedimentation</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/allocate_random_fields/">Allocate random fields</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/allocate_state/">Allocate state</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/array_dict_operations/">Array dict operations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/compile_fortran/">Compile fortran</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/doctor_norm/">Doctor norm</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/env/">Env</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../utils/storage/">Storage</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >testprogs_data</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../testprogs_data/main/">Main</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../testprogs_data/utils/">Utils</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >agent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/ICE4_TENDENCIES_STATUS/">ICE4 Tendencies JAX Translation Status</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../../agent/RAIN_ICE_TRANSITION_PLAN.md">None</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/README_ice_adjust_modular/">Composant ICE_ADJUST Modulaire</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/TRANSLATION_SUMMARY/">JAX Translation Summary</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/README_cloud_fraction/">Test de reproductibilité - cloud_fraction.py vs PHYEX-IAL_CY50T1</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/README_condensation/">Test de reproductibilité - condensation.py vs PHYEX-IAL_CY50T1</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/test_ice4_fast_rg_FIXES/">Fixes Applied to test_ice4_fast_rg.py</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/test_ice4_fast_rs_FIXES/">Fixes Applied to test_ice4_fast_rs.py</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../agent/test_sigrc_computation_FIXES/">Fixes Applied to test_sigrc_computation.py</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">dwarf-ice3-gt4py</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">ice3</li>
          <li class="breadcrumb-item">phyex_common</li>
      <li class="breadcrumb-item active">Rain ice parameters</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="ice3.phyex_common.rain_ice_parameters"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="ice3.phyex_common.rain_ice_parameters.CloudPar" class="doc doc-heading">
            <code>CloudPar</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Declaration of the model-n dependant Microphysic constants</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>nsplitr</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of required small time step integration
for rain sedimentation computation</p>
              </div>
            </li>
            <li>
              <b><code>nsplitg</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Number of required small time step integration
for ice hydrometeor sedimentation computation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>






              <details class="quote">
                <summary>Source code in <code>src/ice3/phyex_common/rain_ice_parameters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CloudPar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Declaration of the model-n dependant Microphysic constants</span>

<span class="sd">    Args:</span>
<span class="sd">        nsplitr (int): Number of required small time step integration</span>
<span class="sd">            for rain sedimentation computation</span>
<span class="sd">        nsplitg (int): Number of required small time step integration</span>
<span class="sd">            for ice hydrometeor sedimentation computation</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nsplitr</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nsplitg</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters" class="doc doc-heading">
            <code>RainIceParameters</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Microphysical rate constants for ICE3/ICE4 bulk schemes.</p>
<p>This dataclass contains all computed rate constants, collection efficiencies,
and kernel coefficients used in the ICE3 and ICE4 microphysics schemes.
Values are computed in <strong>post_init</strong> from fundamental constants (Constants),
hydrometeor descriptors (RainIceDescriptors), and user parameters (IceParameters).</p>
<p>The constants are organized by process type:
- Sedimentation (SED)
- Nucleation (HEN, HON)<br />
- Vapor deposition/Evaporation (DEP, EVA)
- Autoconversion (AUT)
- Aggregation (AGG)
- Accretion (ACC)
- Riming (RIM)
- Contact freezing (CFR)
- Dry/wet graupel growth (DRY/WET)</p>
<h4 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters--attributes">Attributes</h4>
<p><strong>Dependencies (Required for Initialization)</strong></p>


<details class="cst-" open>
  <summary>Constants</summary>
  <p>Physical constants dataclass.</p>
</details>        <p>rid : RainIceDescriptors
    Hydrometeor properties (masses, fall speeds, size distributions).
parami : IceParameters
    User-configurable microphysics parameters.</p>
<p><strong>Sedimentation Constants (SED)</strong></p>
<p>FSEDC_1, FSEDC_2 : float
    Cloud droplet sedimentation factors for bimodal distribution (m/s).
FSEDR : float
    Rain sedimentation pre-factor (m^EXSEDR/s).
EXSEDR : float
    Rain sedimentation exponent (dimensionless).
FSEDI : float
    Ice crystal sedimentation pre-factor.
EXCSEDI, EXRSEDI : float
    Ice crystal sedimentation exponents for concentration and mixing ratio.
FSEDS : float
    Snow sedimentation pre-factor (m^EXSEDS/s).
EXSEDS : float
    Snow sedimentation exponent (dimensionless).
FSEDG : float
    Graupel sedimentation pre-factor (m^EXSEDG/s).
EXSEDG : float
    Graupel sedimentation exponent (dimensionless).</p>
<p><strong>Heterogeneous Ice Nucleation (HENI)</strong></p>


<details class="nu10-" open>
  <summary>float</summary>
  <p>Contact nucleation parameter (m⁻³·s⁻¹), habit-dependent.
Multiplied by 50 for plates, 1250 for columns, 850 for bullet rosettes.</p>
</details>        <p>ALPHA1, BETA1 : float
    Immersion freezing temperature coefficients (dimensionless).
    Formula: N_frz = NU10 × exp(-ALPHA1 × (273.15 - T)^BETA1)
NU20 : float
    Deposition nucleation parameter (m⁻³·s⁻¹), habit-dependent.
ALPHA2, BETA2 : float
    Deposition nucleation temperature coefficients (dimensionless).
MNU0 : float
    Mass of newly nucleated ice crystal (kg). Default: 6.88×10⁻¹³.</p>
<p><strong>Homogeneous Ice Nucleation (HON)</strong></p>
<p>ALPHA3, BETA3 : float
    Homogeneous freezing temperature coefficients.
HON : float
    Homogeneous freezing rate coefficient (m³/s).
    Computed from Fletcher's formula for droplet size distribution.</p>
<p><strong>Vapor Deposition and Evaporation</strong></p>


<details class="scfac-" open>
  <summary>float</summary>
  <p>Schmidt number factor for ventilation (dimensionless).</p>
</details>        <p>Rain Evaporation (EVAR):
O0EVAR, O1EVAR : float
    Evaporation coefficients without and with ventilation (m²/s).
EX0EVAR, EX1EVAR : float
    Exponents for evaporation formulas (dimensionless).</p>
<p>Ice Deposition (DEPI):
O0DEPI, O2DEPI : float
    Deposition coefficients on ice crystals (m²/s).</p>
<p>Snow Deposition (DEPS):
O0DEPS, O1DEPS : float
    Deposition coefficients on snow (m²/s).
EX0DEPS, EX1DEPS : float
    Exponents for snow deposition.
RDEPSRED : float
    Tuning factor for snow deposition (dimensionless). Default: 1.0.</p>
<p>Graupel Deposition (DEPG):
O0DEPG, O1DEPG : float
    Deposition coefficients on graupel (m²/s).
EX0DEPG, EX1DEPG : float
    Exponents for graupel deposition.
RDEPGRED : float
    Tuning factor for graupel deposition (dimensionless). Default: 1.0.</p>
<p><strong>Autoconversion (AUT)</strong></p>
<p>Ice → Snow (IAUTI):
TIMAUTI : float
    Time constant at T = T_t (s). Default: 1×10⁻³.
TEXAUTI : float
    Temperature factor (K⁻¹). Default: 0.015.
CRIAUTI : float
    Threshold ice mixing ratio (kg/kg).
T0CRIAUTI : float
    Threshold temperature (°C).
ACRIAUTI, BCRIAUTI : float
    Power law coefficients: rate = 10^(A×(T-T₀)+B).</p>
<p>Cloud → Rain (AUTC):
TIMAUTC : float
    Time constant (s). Default: 1×10⁻³.
CRIAUTC : float
    Threshold cloud mixing ratio (kg/kg).</p>
<p><strong>Snow Aggregation (AGG)</strong></p>


<details class="colis-" open>
  <summary>float</summary>
  <p>Ice-snow collection efficiency (dimensionless). Default: 0.25.</p>
</details>        <p>COLEXIS : float
    Temperature factor for collection efficiency (K⁻¹). Default: 0.05.
FIAGGS : float
    Aggregation rate pre-factor (m³·kg⁻¹·s⁻¹).
EXIAGGS : float
    Aggregation rate exponent (dimensionless).</p>
<p><strong>Cloud-Rain Accretion (ACC)</strong></p>


<details class="fcaccr-" open>
  <summary>float</summary>
  <p>Accretion rate pre-factor (m³·s⁻¹).</p>
</details>        <p>EXCACCR : float
    Accretion rate exponent (dimensionless).</p>
<p><strong>Snow Riming (RIM)</strong></p>


<details class="dcslim-" open>
  <summary>float</summary>
  <p>Diameter threshold for riming mode transition (m). Default: 7 mm.</p>
</details>        <p>COLCS : float
    Cloud-snow collection efficiency (dimensionless). Default: 1.0.</p>
<p>Small Snow Riming (CRIMSS):
CRIMSS : float
    Riming coefficient for small aggregates (m³·s⁻¹).
EXCRIMSS : float
    Exponent for small aggregate riming.</p>
<p>Large Snow Riming (CRIMSG):
CRIMSG : float
    Riming coefficient for large aggregates (m³·s⁻¹).
EXCRIMSG : float
    Exponent for large aggregate riming.</p>
<p>Snow→Graupel Conversion (RSRIMCG):
SRIMCG, SRIMCG2, SRIMCG3 : float
    Conversion rate coefficients (various units).
EXSRIMCG, EXSRIMCG2 : float
    Conversion rate exponents.</p>
<p><strong>Riming Lookup Tables</strong></p>


<details class="ngaminc-" open>
  <summary>int</summary>
  <p>Number of table values (80).</p>
</details>        <p>GAMINC_BOUND_MIN, GAMINC_BOUND_MAX : float
    Lambda bounds for tables (m⁻¹).
RIMINTP1, RIMINTP2 : float
    Interpolation coefficients.
GAMINC_RIM1, GAMINC_RIM2, GAMINC_RIM4 : NDArray
    Incomplete gamma function tables for riming calculations (80 values each).</p>
<p><strong>Rain-Snow Accretion (RACCS, RACCSS)</strong></p>


<details class="fraccss-" open>
  <summary>float</summary>
  <p>Pre-factor for accretion rate (kg·m⁻⁵·s⁻¹).</p>
</details>        <p>LBRACCS1, LBRACCS2, LBRACCS3 : float
    Lambda-dependent coefficients for small snow accretion.
FSACCRG : float
    Pre-factor for conversion to graupel (m³·s⁻¹).
LBSACCR1, LBSACCR2, LBSACCR3 : float
    Lambda-dependent coefficients for large snow accretion.</p>
<p>ACCLBDAS_MIN, ACCLBDAS_MAX : float
    Snow lambda range for kernel tables (m⁻¹).
ACCLBDAR_MIN, ACCLBDAR_MAX : float
    Rain lambda range for kernel tables (m⁻¹).
NACCLBDAS, NACCLBDAR : int
    Number of table points (40 each).
ACCINTP1S, ACCINTP2S, ACCINTP1R, ACCINTP2R : float
    Interpolation coefficients for kernel tables.</p>
<p><strong>Snow Melting</strong></p>


<details class="fscvmg-" open>
  <summary>float</summary>
  <p>Conversion-melting factor (dimensionless). Default: 2.0.</p>
</details>        <p><strong>Rain Contact Freezing (CFR)</strong></p>


<details class="colir-" open>
  <summary>float</summary>
  <p>Ice-rain collection efficiency (dimensionless). Default: 1.0.</p>
</details>        <p>EXRCFRI, RCFRI : float
    Rain contact freezing rate coefficients.
EXICFRR, ICFRR : float
    Ice-rain freezing coefficients.</p>
<p><strong>Graupel Dry Growth (DRY)</strong></p>
<p>Cloud Collection:
FCDRYG : float
    Cloud droplet collection geometric factor (π/4).</p>
<p>Ice Collection:
COLIG : float
    Ice-graupel collection efficiency. Default: 0.01.
COLEXIG : float
    Temperature factor for ice-graupel. Default: 0.1.
FIDRYG, FIDRYG2 : float
    Ice collection rate coefficients.
EXFIDRYG : float
    Ice collection exponent.</p>
<p>Snow Collection:
COLSG : float
    Snow-graupel collection efficiency. Default: 0.01.
COLEXSG : float
    Temperature factor for snow-graupel. Default: 0.1.
FSDRYG : float
    Snow collection coefficient.
LBSDRYG1, LBSDRYG2, LBSDRYG3 : float
    Lambda-dependent coefficients.</p>
<p>Rain Collection:
FRDRYG : float
    Rain collection coefficient.
LBRDRYG1, LBRDRYG2, LBRDRYG3 : float
    Lambda-dependent coefficients.</p>
<p>Dry Growth Kernel Tables:
DRYLBDAR_MIN, DRYLBDAR_MAX : float
    Rain lambda bounds (m⁻¹).
DRYLBDAS_MIN, DRYLBDAS_MAX : float
    Snow lambda bounds (m⁻¹).
DRYLBDAG_MIN, DRYLBDAG_MAX : float
    Graupel lambda bounds (m⁻¹).
NDRYLBDAR, NDRYLBDAS, NDRYLBDAG : int
    Table dimensions (40, 80, 40).
DRYINTP1R, DRYINTP2R, etc. : float
    Interpolation coefficients.</p>
<p><strong>Precomputed Kernels</strong></p>
<p>ker_saccrg, ker_raccs, ker_raccss : NDArray
    Snow-graupel and rain-snow accretion kernels (40×40).
ker_rdryg, ker_sdryg : NDArray
    Rain and snow dry growth kernels on graupel (40×40 or 40×80).</p>
<h4 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters--notes">Notes</h4>
<p>All constants are computed in <strong>post_init</strong> based on:
- Hydrometeor size distributions (N(D) = N₀ × D^ν × exp(-λD^α))
- Fall speed relations (V = A × D^B × (ρ/ρ₀)^C)
- Collection kernels from kinetic equations
- Moment integrals using gamma functions</p>
<p>The formulas account for:
- Air density corrections (rho00 factor)
- Ventilation effects (enhanced mass/heat transfer)
- Temperature dependencies
- Particle habit variations</p>
<h4 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters--source-reference">Source Reference</h4>
<p>PHYEX/src/common/aux/modd_rain_ice_paramn.F90
PHYEX/src/common/micro/mode_ini_rain_ice.F90</p>
<h4 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters--see-also">See Also</h4>
<p>Constants : Physical constants
RainIceDescriptors : Hydrometeor properties
IceParameters : User configuration</p>







              <details class="quote">
                <summary>Source code in <code>src/ice3/phyex_common/rain_ice_parameters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RainIceParameters</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Microphysical rate constants for ICE3/ICE4 bulk schemes.</span>

<span class="sd">    This dataclass contains all computed rate constants, collection efficiencies,</span>
<span class="sd">    and kernel coefficients used in the ICE3 and ICE4 microphysics schemes.</span>
<span class="sd">    Values are computed in __post_init__ from fundamental constants (Constants),</span>
<span class="sd">    hydrometeor descriptors (RainIceDescriptors), and user parameters (IceParameters).</span>

<span class="sd">    The constants are organized by process type:</span>
<span class="sd">    - Sedimentation (SED)</span>
<span class="sd">    - Nucleation (HEN, HON)  </span>
<span class="sd">    - Vapor deposition/Evaporation (DEP, EVA)</span>
<span class="sd">    - Autoconversion (AUT)</span>
<span class="sd">    - Aggregation (AGG)</span>
<span class="sd">    - Accretion (ACC)</span>
<span class="sd">    - Riming (RIM)</span>
<span class="sd">    - Contact freezing (CFR)</span>
<span class="sd">    - Dry/wet graupel growth (DRY/WET)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    **Dependencies (Required for Initialization)**</span>

<span class="sd">    cst : Constants</span>
<span class="sd">        Physical constants dataclass.</span>
<span class="sd">    rid : RainIceDescriptors</span>
<span class="sd">        Hydrometeor properties (masses, fall speeds, size distributions).</span>
<span class="sd">    parami : IceParameters</span>
<span class="sd">        User-configurable microphysics parameters.</span>

<span class="sd">    **Sedimentation Constants (SED)**</span>

<span class="sd">    FSEDC_1, FSEDC_2 : float</span>
<span class="sd">        Cloud droplet sedimentation factors for bimodal distribution (m/s).</span>
<span class="sd">    FSEDR : float</span>
<span class="sd">        Rain sedimentation pre-factor (m^EXSEDR/s).</span>
<span class="sd">    EXSEDR : float</span>
<span class="sd">        Rain sedimentation exponent (dimensionless).</span>
<span class="sd">    FSEDI : float</span>
<span class="sd">        Ice crystal sedimentation pre-factor.</span>
<span class="sd">    EXCSEDI, EXRSEDI : float</span>
<span class="sd">        Ice crystal sedimentation exponents for concentration and mixing ratio.</span>
<span class="sd">    FSEDS : float</span>
<span class="sd">        Snow sedimentation pre-factor (m^EXSEDS/s).</span>
<span class="sd">    EXSEDS : float</span>
<span class="sd">        Snow sedimentation exponent (dimensionless).</span>
<span class="sd">    FSEDG : float</span>
<span class="sd">        Graupel sedimentation pre-factor (m^EXSEDG/s).</span>
<span class="sd">    EXSEDG : float</span>
<span class="sd">        Graupel sedimentation exponent (dimensionless).</span>

<span class="sd">    **Heterogeneous Ice Nucleation (HENI)**</span>

<span class="sd">    NU10 : float</span>
<span class="sd">        Contact nucleation parameter (m⁻³·s⁻¹), habit-dependent.</span>
<span class="sd">        Multiplied by 50 for plates, 1250 for columns, 850 for bullet rosettes.</span>
<span class="sd">    ALPHA1, BETA1 : float</span>
<span class="sd">        Immersion freezing temperature coefficients (dimensionless).</span>
<span class="sd">        Formula: N_frz = NU10 × exp(-ALPHA1 × (273.15 - T)^BETA1)</span>
<span class="sd">    NU20 : float</span>
<span class="sd">        Deposition nucleation parameter (m⁻³·s⁻¹), habit-dependent.</span>
<span class="sd">    ALPHA2, BETA2 : float</span>
<span class="sd">        Deposition nucleation temperature coefficients (dimensionless).</span>
<span class="sd">    MNU0 : float</span>
<span class="sd">        Mass of newly nucleated ice crystal (kg). Default: 6.88×10⁻¹³.</span>

<span class="sd">    **Homogeneous Ice Nucleation (HON)**</span>

<span class="sd">    ALPHA3, BETA3 : float</span>
<span class="sd">        Homogeneous freezing temperature coefficients.</span>
<span class="sd">    HON : float</span>
<span class="sd">        Homogeneous freezing rate coefficient (m³/s).</span>
<span class="sd">        Computed from Fletcher&#39;s formula for droplet size distribution.</span>

<span class="sd">    **Vapor Deposition and Evaporation**</span>

<span class="sd">    SCFAC : float</span>
<span class="sd">        Schmidt number factor for ventilation (dimensionless).</span>

<span class="sd">    Rain Evaporation (EVAR):</span>
<span class="sd">    O0EVAR, O1EVAR : float</span>
<span class="sd">        Evaporation coefficients without and with ventilation (m²/s).</span>
<span class="sd">    EX0EVAR, EX1EVAR : float</span>
<span class="sd">        Exponents for evaporation formulas (dimensionless).</span>

<span class="sd">    Ice Deposition (DEPI):</span>
<span class="sd">    O0DEPI, O2DEPI : float</span>
<span class="sd">        Deposition coefficients on ice crystals (m²/s).</span>

<span class="sd">    Snow Deposition (DEPS):</span>
<span class="sd">    O0DEPS, O1DEPS : float</span>
<span class="sd">        Deposition coefficients on snow (m²/s).</span>
<span class="sd">    EX0DEPS, EX1DEPS : float</span>
<span class="sd">        Exponents for snow deposition.</span>
<span class="sd">    RDEPSRED : float</span>
<span class="sd">        Tuning factor for snow deposition (dimensionless). Default: 1.0.</span>

<span class="sd">    Graupel Deposition (DEPG):</span>
<span class="sd">    O0DEPG, O1DEPG : float</span>
<span class="sd">        Deposition coefficients on graupel (m²/s).</span>
<span class="sd">    EX0DEPG, EX1DEPG : float</span>
<span class="sd">        Exponents for graupel deposition.</span>
<span class="sd">    RDEPGRED : float</span>
<span class="sd">        Tuning factor for graupel deposition (dimensionless). Default: 1.0.</span>

<span class="sd">    **Autoconversion (AUT)**</span>

<span class="sd">    Ice → Snow (IAUTI):</span>
<span class="sd">    TIMAUTI : float</span>
<span class="sd">        Time constant at T = T_t (s). Default: 1×10⁻³.</span>
<span class="sd">    TEXAUTI : float</span>
<span class="sd">        Temperature factor (K⁻¹). Default: 0.015.</span>
<span class="sd">    CRIAUTI : float</span>
<span class="sd">        Threshold ice mixing ratio (kg/kg).</span>
<span class="sd">    T0CRIAUTI : float</span>
<span class="sd">        Threshold temperature (°C).</span>
<span class="sd">    ACRIAUTI, BCRIAUTI : float</span>
<span class="sd">        Power law coefficients: rate = 10^(A×(T-T₀)+B).</span>

<span class="sd">    Cloud → Rain (AUTC):</span>
<span class="sd">    TIMAUTC : float</span>
<span class="sd">        Time constant (s). Default: 1×10⁻³.</span>
<span class="sd">    CRIAUTC : float</span>
<span class="sd">        Threshold cloud mixing ratio (kg/kg).</span>

<span class="sd">    **Snow Aggregation (AGG)**</span>

<span class="sd">    COLIS : float</span>
<span class="sd">        Ice-snow collection efficiency (dimensionless). Default: 0.25.</span>
<span class="sd">    COLEXIS : float</span>
<span class="sd">        Temperature factor for collection efficiency (K⁻¹). Default: 0.05.</span>
<span class="sd">    FIAGGS : float</span>
<span class="sd">        Aggregation rate pre-factor (m³·kg⁻¹·s⁻¹).</span>
<span class="sd">    EXIAGGS : float</span>
<span class="sd">        Aggregation rate exponent (dimensionless).</span>

<span class="sd">    **Cloud-Rain Accretion (ACC)**</span>

<span class="sd">    FCACCR : float</span>
<span class="sd">        Accretion rate pre-factor (m³·s⁻¹).</span>
<span class="sd">    EXCACCR : float</span>
<span class="sd">        Accretion rate exponent (dimensionless).</span>

<span class="sd">    **Snow Riming (RIM)**</span>

<span class="sd">    DCSLIM : float</span>
<span class="sd">        Diameter threshold for riming mode transition (m). Default: 7 mm.</span>
<span class="sd">    COLCS : float</span>
<span class="sd">        Cloud-snow collection efficiency (dimensionless). Default: 1.0.</span>

<span class="sd">    Small Snow Riming (CRIMSS):</span>
<span class="sd">    CRIMSS : float</span>
<span class="sd">        Riming coefficient for small aggregates (m³·s⁻¹).</span>
<span class="sd">    EXCRIMSS : float</span>
<span class="sd">        Exponent for small aggregate riming.</span>

<span class="sd">    Large Snow Riming (CRIMSG):</span>
<span class="sd">    CRIMSG : float</span>
<span class="sd">        Riming coefficient for large aggregates (m³·s⁻¹).</span>
<span class="sd">    EXCRIMSG : float</span>
<span class="sd">        Exponent for large aggregate riming.</span>

<span class="sd">    Snow→Graupel Conversion (RSRIMCG):</span>
<span class="sd">    SRIMCG, SRIMCG2, SRIMCG3 : float</span>
<span class="sd">        Conversion rate coefficients (various units).</span>
<span class="sd">    EXSRIMCG, EXSRIMCG2 : float</span>
<span class="sd">        Conversion rate exponents.</span>

<span class="sd">    **Riming Lookup Tables**</span>

<span class="sd">    NGAMINC : int</span>
<span class="sd">        Number of table values (80).</span>
<span class="sd">    GAMINC_BOUND_MIN, GAMINC_BOUND_MAX : float</span>
<span class="sd">        Lambda bounds for tables (m⁻¹).</span>
<span class="sd">    RIMINTP1, RIMINTP2 : float</span>
<span class="sd">        Interpolation coefficients.</span>
<span class="sd">    GAMINC_RIM1, GAMINC_RIM2, GAMINC_RIM4 : NDArray</span>
<span class="sd">        Incomplete gamma function tables for riming calculations (80 values each).</span>

<span class="sd">    **Rain-Snow Accretion (RACCS, RACCSS)**</span>

<span class="sd">    FRACCSS : float</span>
<span class="sd">        Pre-factor for accretion rate (kg·m⁻⁵·s⁻¹).</span>
<span class="sd">    LBRACCS1, LBRACCS2, LBRACCS3 : float</span>
<span class="sd">        Lambda-dependent coefficients for small snow accretion.</span>
<span class="sd">    FSACCRG : float</span>
<span class="sd">        Pre-factor for conversion to graupel (m³·s⁻¹).</span>
<span class="sd">    LBSACCR1, LBSACCR2, LBSACCR3 : float</span>
<span class="sd">        Lambda-dependent coefficients for large snow accretion.</span>

<span class="sd">    ACCLBDAS_MIN, ACCLBDAS_MAX : float</span>
<span class="sd">        Snow lambda range for kernel tables (m⁻¹).</span>
<span class="sd">    ACCLBDAR_MIN, ACCLBDAR_MAX : float</span>
<span class="sd">        Rain lambda range for kernel tables (m⁻¹).</span>
<span class="sd">    NACCLBDAS, NACCLBDAR : int</span>
<span class="sd">        Number of table points (40 each).</span>
<span class="sd">    ACCINTP1S, ACCINTP2S, ACCINTP1R, ACCINTP2R : float</span>
<span class="sd">        Interpolation coefficients for kernel tables.</span>

<span class="sd">    **Snow Melting**</span>

<span class="sd">    FSCVMG : float</span>
<span class="sd">        Conversion-melting factor (dimensionless). Default: 2.0.</span>

<span class="sd">    **Rain Contact Freezing (CFR)**</span>

<span class="sd">    COLIR : float</span>
<span class="sd">        Ice-rain collection efficiency (dimensionless). Default: 1.0.</span>
<span class="sd">    EXRCFRI, RCFRI : float</span>
<span class="sd">        Rain contact freezing rate coefficients.</span>
<span class="sd">    EXICFRR, ICFRR : float</span>
<span class="sd">        Ice-rain freezing coefficients.</span>

<span class="sd">    **Graupel Dry Growth (DRY)**</span>

<span class="sd">    Cloud Collection:</span>
<span class="sd">    FCDRYG : float</span>
<span class="sd">        Cloud droplet collection geometric factor (π/4).</span>

<span class="sd">    Ice Collection:</span>
<span class="sd">    COLIG : float</span>
<span class="sd">        Ice-graupel collection efficiency. Default: 0.01.</span>
<span class="sd">    COLEXIG : float</span>
<span class="sd">        Temperature factor for ice-graupel. Default: 0.1.</span>
<span class="sd">    FIDRYG, FIDRYG2 : float</span>
<span class="sd">        Ice collection rate coefficients.</span>
<span class="sd">    EXFIDRYG : float</span>
<span class="sd">        Ice collection exponent.</span>

<span class="sd">    Snow Collection:</span>
<span class="sd">    COLSG : float</span>
<span class="sd">        Snow-graupel collection efficiency. Default: 0.01.</span>
<span class="sd">    COLEXSG : float</span>
<span class="sd">        Temperature factor for snow-graupel. Default: 0.1.</span>
<span class="sd">    FSDRYG : float</span>
<span class="sd">        Snow collection coefficient.</span>
<span class="sd">    LBSDRYG1, LBSDRYG2, LBSDRYG3 : float</span>
<span class="sd">        Lambda-dependent coefficients.</span>

<span class="sd">    Rain Collection:</span>
<span class="sd">    FRDRYG : float</span>
<span class="sd">        Rain collection coefficient.</span>
<span class="sd">    LBRDRYG1, LBRDRYG2, LBRDRYG3 : float</span>
<span class="sd">        Lambda-dependent coefficients.</span>

<span class="sd">    Dry Growth Kernel Tables:</span>
<span class="sd">    DRYLBDAR_MIN, DRYLBDAR_MAX : float</span>
<span class="sd">        Rain lambda bounds (m⁻¹).</span>
<span class="sd">    DRYLBDAS_MIN, DRYLBDAS_MAX : float</span>
<span class="sd">        Snow lambda bounds (m⁻¹).</span>
<span class="sd">    DRYLBDAG_MIN, DRYLBDAG_MAX : float</span>
<span class="sd">        Graupel lambda bounds (m⁻¹).</span>
<span class="sd">    NDRYLBDAR, NDRYLBDAS, NDRYLBDAG : int</span>
<span class="sd">        Table dimensions (40, 80, 40).</span>
<span class="sd">    DRYINTP1R, DRYINTP2R, etc. : float</span>
<span class="sd">        Interpolation coefficients.</span>

<span class="sd">    **Precomputed Kernels**</span>

<span class="sd">    ker_saccrg, ker_raccs, ker_raccss : NDArray</span>
<span class="sd">        Snow-graupel and rain-snow accretion kernels (40×40).</span>
<span class="sd">    ker_rdryg, ker_sdryg : NDArray</span>
<span class="sd">        Rain and snow dry growth kernels on graupel (40×40 or 40×80).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    All constants are computed in __post_init__ based on:</span>
<span class="sd">    - Hydrometeor size distributions (N(D) = N₀ × D^ν × exp(-λD^α))</span>
<span class="sd">    - Fall speed relations (V = A × D^B × (ρ/ρ₀)^C)</span>
<span class="sd">    - Collection kernels from kinetic equations</span>
<span class="sd">    - Moment integrals using gamma functions</span>

<span class="sd">    The formulas account for:</span>
<span class="sd">    - Air density corrections (rho00 factor)</span>
<span class="sd">    - Ventilation effects (enhanced mass/heat transfer)</span>
<span class="sd">    - Temperature dependencies</span>
<span class="sd">    - Particle habit variations</span>

<span class="sd">    Source Reference</span>
<span class="sd">    ----------------</span>
<span class="sd">    PHYEX/src/common/aux/modd_rain_ice_paramn.F90</span>
<span class="sd">    PHYEX/src/common/micro/mode_ini_rain_ice.F90</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Constants : Physical constants</span>
<span class="sd">    RainIceDescriptors : Hydrometeor properties</span>
<span class="sd">    IceParameters : User configuration</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constants dependencies</span>
    <span class="n">cst</span><span class="p">:</span> <span class="n">Constants</span>
    <span class="n">rid</span><span class="p">:</span> <span class="n">RainIceDescriptors</span>
    <span class="n">parami</span><span class="p">:</span> <span class="n">IceParameters</span>

    <span class="c1"># Parameters for microphysical sources and transformations</span>
    <span class="n">FSEDC_1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Constants for sedimentation fluxes of C</span>
    <span class="n">FSEDC_2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FSEDR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Constants for sedimentation</span>
    <span class="n">EXSEDR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FSEDI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXCSEDI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXRSEDI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FSEDS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXSEDS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FSEDG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXSEDG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for heterogeneous ice nucleation HEN</span>
    <span class="n">NU10</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ALPHA1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.5</span>
    <span class="n">BETA1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span>
    <span class="n">NU20</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ALPHA2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.96</span>
    <span class="n">BETA2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.639</span>
    <span class="n">MNU0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.88e-13</span>  <span class="c1"># Mass of nucleated ice crystal</span>

    <span class="c1"># Constants for homogeneous ice nucleation HON</span>
    <span class="n">ALPHA3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.075</span>
    <span class="n">BETA3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">81.00356</span>
    <span class="n">HON</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for raindrop and evaporation EVA</span>
    <span class="n">SCFAC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">O0EVAR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">O1EVAR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX0EVAR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX1EVAR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">O0DEPI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># deposition DEP on I</span>
    <span class="n">O2DEPI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">O0DEPS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># on S</span>
    <span class="n">O1DEPS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX0DEPS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX1DEPS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">RDEPSRED</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">O0DEPG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># on G</span>
    <span class="n">O1DEPG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX0DEPG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EX1DEPG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">RDEPGRED</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for pristine ice autoconversion : AUT</span>
    <span class="n">TIMAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># Time constant at T=T_t</span>
    <span class="n">TEXAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.015</span>
    <span class="n">CRIAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">T0CRIAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ACRIAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">BCRIAUTI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for snow aggregation : AGG</span>
    <span class="n">COLIS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># Collection efficiency of I + S</span>
    <span class="n">COLEXIS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Temperature factor of the I+S collection efficiency</span>
    <span class="n">FIAGGS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXIAGGS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for cloud droplet autoconversion AUT</span>
    <span class="n">TIMAUTC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
    <span class="n">CRIAUTC</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for cloud droplets accretion on raindrops : ACC</span>
    <span class="n">FCACCR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXCACCR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for the riming of the aggregates : RIM</span>
    <span class="n">DCSLIM</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.007</span>
    <span class="n">COLCS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">EXCRIMSS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">CRIMSS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXCRIMSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">CRIMSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">EXCRIMSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">CRIMSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXSRIMCG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXSRIMCG2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">SRIMCG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">SRIMCG2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">SRIMCG3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">GAMINC_BOUND_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">GAMINC_BOUND_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">RIMINTP1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">RIMINTP2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">NGAMINC</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Number of tab. Lbda_s</span>

    <span class="n">GAMINC_RIM1</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">GAMINC_RIM2</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">GAMINC_RIM4</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for the accretion</span>
    <span class="n">FRACCSS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRACCS1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRACCS2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRACCS3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FSACCRG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSACCR1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSACCR2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSACCR3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ACCLBDAS_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">5e1</span><span class="p">)</span>
    <span class="n">ACCLBDAS_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">5e5</span><span class="p">)</span>
    <span class="n">ACCLBDAR_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
    <span class="n">ACCLBDAR_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span>
    <span class="n">ACCINTP1S</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ACCINTP2S</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ACCINTP1R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ACCINTP2R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># number of values in global tables (per axis)</span>
    <span class="n">NACCLBDAS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">NACCLBDAR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

    <span class="c1"># 7.3 Constant for the conversion-melting rate</span>
    <span class="n">FSCVMG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Constants for rain contact freezing</span>
    <span class="n">COLIR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">EXRCFRI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">RCFRI</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXICFRR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ICFRR</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Constants for the dry growth of the graupel : DRY</span>
    <span class="n">FCDRYG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">COLIG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">COLEXIG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">FIDRYG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FIDRYG2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EXFIDRYG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">COLSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">COLEXSG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">FSDRYG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSDRYG1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSDRYG2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBSDRYG3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">FRDRYG</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRDRYG1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRDRYG2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LBRDRYG3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYLBDAR_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
    <span class="n">DRYLBDAR_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span>
    <span class="n">DRYLBDAS_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">2.5e1</span><span class="p">)</span>
    <span class="n">DRYLBDAS_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">2.5e9</span><span class="p">)</span>
    <span class="n">DRYLBDAG_MIN</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
    <span class="n">DRYLBDAG_MAX</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span>
    <span class="n">DRYINTP1R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYINTP2R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYINTP1S</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYINTP2S</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYINTP1G</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">DRYINTP2G</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">NDRYLBDAR</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">NDRYLBDAS</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">NDRYLBDAG</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 4. CONSTANTS FOR THE SEDIMENTATION</span>
        <span class="c1"># 4.1 Exponent of the fall-speed air density correction</span>

        <span class="n">e</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">ALPW</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">BETAW</span> <span class="o">/</span> <span class="mf">293.15</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">GAMW</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mf">293.15</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RD_RV</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span> <span class="o">/</span> <span class="p">(</span><span class="mi">101325</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">rho00</span> <span class="o">=</span> <span class="mi">101325</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rv</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RD</span> <span class="o">+</span> <span class="n">rv</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RV</span><span class="p">)</span> <span class="o">/</span> <span class="mf">293.15</span>

        <span class="c1"># 4.2    Constants for sedimentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSEDC_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FSEDC_2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUC</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DC</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAC</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUC</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAC</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUC2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DC</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAC2</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUC2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAC2</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">momg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">gamma</span><span class="p">(</span><span class="n">nu</span> <span class="o">+</span> <span class="n">p</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXSEDR</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BR</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BR</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSEDR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CR</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AR</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BR</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AR</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
                <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BR</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">EXSEDR</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXRSEDI</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BI</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DI</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXCSEDI</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">EXRSEDI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSEDI</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">900</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">EXCSEDI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C_I</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AI</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BI</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DI</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AI</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BI</span><span class="p">))</span>
                <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">EXRSEDI</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXSEDS</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SEDS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">A_S</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">A_S</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
                <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">EXSEDS</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
        <span class="p">)</span>

        <span class="c1"># if self.parami.LRED:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXSEDS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSEDS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CS</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXSEDG</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSEDG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AG</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
                <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">EXSEDG</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">rho00</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span>
        <span class="p">)</span>

        <span class="c1"># 5. Constants for the slow cold processes</span>
        <span class="n">fact_nucl</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">PRISTINE_ICE</span> <span class="o">==</span> <span class="s2">&quot;PLAT&quot;</span><span class="p">:</span>
            <span class="n">fact_nucl</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Plates</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">PRISTINE_ICE</span> <span class="o">==</span> <span class="s2">&quot;COLU&quot;</span><span class="p">:</span>
            <span class="n">fact_nucl</span> <span class="o">=</span> <span class="mf">25.0</span>  <span class="c1"># Columns</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">PRISTINE_ICE</span> <span class="o">==</span> <span class="s2">&quot;BURO&quot;</span><span class="p">:</span>
            <span class="n">fact_nucl</span> <span class="o">=</span> <span class="mf">17.0</span>  <span class="c1"># Bullet rosettes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NU10</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">fact_nucl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NU20</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">fact_nucl</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">HON</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.1e5</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># 5.2 Constants for vapor deposition on ice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SCFAC</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.63</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">rho00</span><span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O0DEPI</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1I</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F0I</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUI</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O2DEPI</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1I</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F2I</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C_I</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DI</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Translation note: #ifdef REPRO48 l588 to l591 kept in mode_ini_rain_ice.F90</span>
        <span class="c1">#                                  l593 to l596 removed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O0DEPS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NS</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1S</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F0S</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O1DEPS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NS</span>
            <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1S</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F1S</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CS</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX0DEPS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX1DEPS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RDEPSRED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">RDEPSRED_NAM</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">O0DEPG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1G</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F0G</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O1DEPG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1G</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F1G</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CG</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX0DEPG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX1DEPG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RDEPGRED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">RDEPGRED_NAM</span>

        <span class="c1"># 5.3 Constants for pristine ice autoconversion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CRIAUTI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">CRIAUTI_NAM</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">LCRIAUTI</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T0CRIAUTI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">T0CRIAUTI_NAM</span>
            <span class="n">tcrio</span> <span class="o">=</span> <span class="o">-</span><span class="mi">40</span>
            <span class="n">crio</span> <span class="o">=</span> <span class="mf">1.25e-6</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BCRIAUTI</span> <span class="o">=</span> <span class="p">(</span>
                <span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CRIAUTI</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">crio</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0CRIAUTI</span> <span class="o">/</span> <span class="n">tcrio</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">tcrio</span>
                <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T0CRIAUTI</span> <span class="o">-</span> <span class="n">tcrio</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ACRIAUTI</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">crio</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">BCRIAUTI</span><span class="p">)</span> <span class="o">/</span> <span class="n">tcrio</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ACRIAUTI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">ACRIAUTI_NAM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BCRIAUTI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">BRCRIAUTI_NAM</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T0CRIAUTI</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CRIAUTI</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">BCRIAUTI</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.06</span>

        <span class="c1"># 5.4 Constants for snow aggregation</span>
        <span class="c1"># Translation note: #ifdef REPRO48 l655 to l656 kept in mode_ini_rain_ice.F90</span>
        <span class="c1">#                                  l658 to l659 removed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FIAGGS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLIS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CS</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXIAGGS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">-</span> <span class="mf">2.0</span>

        <span class="c1"># 6. Constants for the slow warm processes</span>
        <span class="c1"># 6.1 Constants for the accretion of cloud droplets autoconversion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CRIAUTC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">CRIAUTC_NAM</span>

        <span class="c1"># 6.2 Constants for the accretion of cloud droplets by raindrops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FCACCR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CR</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXCACCR</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">-</span> <span class="mf">3.0</span>

        <span class="c1"># 6.3 Constants for the evaporation of rain drops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O0EVAR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F0R</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">O1EVAR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">C1R</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">F1R</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX0EVAR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EX1EVAR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span>

        <span class="c1"># 7. Constants for the fast cold processes for the aggregateDS</span>
        <span class="c1"># 7.1 Constants for the riming of the aggregates</span>

        <span class="c1"># Translation note: #ifdef REPRO48 l712 and l713 kept in mode_ini_rain_ice.F90</span>
        <span class="c1">#                                  l715 and l716 removed</span>

        <span class="c1"># Translation note: #ifdef REPRO48 l721 to l725 kept in mode_ini_rain_ice.F90</span>
        <span class="c1">#                                  l727 to l731 removed</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXCRIMSS</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">-</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CRIMSS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NS</span>
            <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CS</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXCRIMSG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EXCRIMSS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CRIMSG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CRIMSS</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SRIMCG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">A_S</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXSRIMCG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRIMCG2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AG</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SRIMCG3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parami</span><span class="o">.</span><span class="n">FRAC_M90</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXSRIMCG2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXS</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">=</span> <span class="mi">80</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">=</span> <span class="mf">1e-1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MAX</span> <span class="o">=</span> <span class="mf">1e7</span>
        <span class="n">zrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RIMINTP1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">zrate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RIMINTP2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">RIMINTP1</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DCSLIM</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># init GAMINC_RIM1, GAMINC_RIM2, GAMINC_RIM4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_gaminc_rim_tables</span><span class="p">()</span>

        <span class="c1"># 7.2 Constants for the accretion of raindrops</span>

        <span class="c1"># Translation note: #ifdef REPRO48 l763 kept</span>
        <span class="c1">#                                  l765 removed</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FRACCSS</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RHOLW</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LBRACCS1</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">3</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBRACCS2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBRACCS3</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Translation note : #ifdef REPRO48 l773 kept</span>
        <span class="c1">#                                   l775 removed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSACCRG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">A_S</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCS</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LBSACCR1</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBSACCR2</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBSACCR3</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Defining the ranges for the computation of kernels</span>
        <span class="n">zrate</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAS_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAS_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NACCLBDAS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCINTP1S</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">zrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCINTP2S</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAS_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="n">zrate</span>

        <span class="n">zrate</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAR_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAR_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NACCLBDAR</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCINTP1R</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">zrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCINTP2R</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ACCLBDAR_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="n">zrate</span>

        <span class="c1"># Translation note : l800 to 902 -&gt; computation of the kernels</span>

        <span class="c1"># 8 Constants for the fast cold processes for the graupel</span>

        <span class="c1"># 8.1 Constants for the rain contact freezing</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXRCFRI</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">xr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RCFRI</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RHOLW</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLIR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CR</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EXICFRR</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">xr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ICFRR</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLIR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CR</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DR</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 8.2 Constants for the dry growth of the graupel</span>

        <span class="c1"># 8.2.1 Constants for the cloud droplets collection by the graupel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FCDRYG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span>

        <span class="c1"># 8.2.2 Constants for the cloud ice collection by the graupel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FIDRYG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLIG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXFIDRYG</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DG</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CXG</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FIDRYG2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FIDRYG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">COLIG</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">AG</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
                <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BG</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 8.2.3 Constants for the aggregate collection by the graupel</span>
        <span class="c1"># Translation note : #ifdef REPRO48 l973 kept</span>
        <span class="c1">#                                   l975 removed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FSDRYG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCR</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RHOLW</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBSDRYG1</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBSDRYG2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBSDRYG3</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># 8.2.4 Constants for the raindrop collection by the graupel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FRDRYG</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">PI</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CCG</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cst</span><span class="o">.</span><span class="n">RHOLW</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">rho00</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">CEXVT</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBRDRYG1</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">momg</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">3</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBRDRYG2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LBRDRYG3</span> <span class="o">=</span> <span class="n">momg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUR</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Notice: one magnitude of lambda discretized over 10 points</span>
        <span class="n">zrate</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAR_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAR_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDRYLBDAR</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP1R</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">zrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP2R</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAR_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="n">zrate</span>

        <span class="n">zrate</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAS_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAS_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDRYLBDAS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP1S</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">zrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP2S</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAS_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="n">zrate</span>

        <span class="n">zrate</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAG_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAG_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDRYLBDAG</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP1G</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">zrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DRYINTP2G</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DRYLBDAG_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="n">zrate</span>

        <span class="c1"># Translation note : l1018 to l1152 -&gt; computation of the kernels</span>

        <span class="c1"># Tranlsation note : l1154 to l1160 skipped</span>

        <span class="c1"># Tranlsation note : 9. Constants for hailstones not implemented</span>
        <span class="c1">#                    l1162 to l1481 removed</span>

        <span class="c1"># kernels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ker_saccrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kernel</span><span class="p">(</span><span class="s2">&quot;saccrg&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ker_raccs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kernel</span><span class="p">(</span><span class="s2">&quot;raccs&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ker_raccss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kernel</span><span class="p">(</span><span class="s2">&quot;raccss&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ker_rdryg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kernel</span><span class="p">(</span><span class="s2">&quot;rdryg&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ker_sdryg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kernel</span><span class="p">(</span><span class="s2">&quot;sdryg&quot;</span><span class="p">)</span>

    <span class="c1"># from_file=&quot;PHYEX/src/common/micro/mode_ini_rain_ice.F90&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_gaminc_rim_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute generalized incomplete gamma tables for riming&quot;&quot;&quot;</span>

        <span class="n">zrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;a factor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="si">}</span><span class="s2">, GAMINC * zrate = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">zrate</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Value error while computing generalized_incomplete_gamma : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
            <span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
            <span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">GAMINC_RIM1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">GAMINC_RIM2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">GAMINC_RIM4</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_kernel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">kernel</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load kernels for convolutions as numpy arrays</span>

<span class="sd">        Args:</span>
<span class="sd">            kernel (str): kernel to load</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: Error if name is not in kernel names (saccrg, raccs, raccss, rdryg, sdryg)</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: python indented kernel (from 0 to n-1, instead 1 to n in fortran)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;saccrg&quot;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_SACCRG</span>

            <span class="k">return</span> <span class="n">KER_SACCRG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;raccs&quot;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RACCS</span>

            <span class="k">return</span> <span class="n">KER_RACCS</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;raccss&quot;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RACCSS</span>

            <span class="k">return</span> <span class="n">KER_RACCSS</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;rdryg&quot;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_rdryg</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RDRYG</span>

            <span class="k">return</span> <span class="n">KER_RDRYG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;sdryg&quot;</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_sdryg</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_SDRYG</span>

            <span class="k">return</span> <span class="n">KER_SDRYG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> not found in GlobalTables&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters.get_kernel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_kernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load kernels for convolutions as numpy arrays</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>kernel</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>kernel to load</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="KeyError">KeyError</span></code>
              –
              <div class="doc-md-description">
                <p>Error if name is not in kernel names (saccrg, raccs, raccss, rdryg, sdryg)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>_type_</code></b>              –
              <div class="doc-md-description">
                <p>python indented kernel (from 0 to n-1, instead 1 to n in fortran)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ice3/phyex_common/rain_ice_parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_kernel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">kernel</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load kernels for convolutions as numpy arrays</span>

<span class="sd">    Args:</span>
<span class="sd">        kernel (str): kernel to load</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: Error if name is not in kernel names (saccrg, raccs, raccss, rdryg, sdryg)</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: python indented kernel (from 0 to n-1, instead 1 to n in fortran)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;saccrg&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_SACCRG</span>

        <span class="k">return</span> <span class="n">KER_SACCRG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;raccs&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RACCS</span>

        <span class="k">return</span> <span class="n">KER_RACCS</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;raccss&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_raccs</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RACCSS</span>

        <span class="k">return</span> <span class="n">KER_RACCSS</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;rdryg&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_rdryg</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_RDRYG</span>

        <span class="k">return</span> <span class="n">KER_RDRYG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s2">&quot;sdryg&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">ice3.phyex_common.xker_sdryg</span><span class="w"> </span><span class="kn">import</span> <span class="n">KER_SDRYG</span>

        <span class="k">return</span> <span class="n">KER_SDRYG</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> not found in GlobalTables&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ice3.phyex_common.rain_ice_parameters.RainIceParameters.init_gaminc_rim_tables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_gaminc_rim_tables</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute generalized incomplete gamma tables for riming</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ice3/phyex_common/rain_ice_parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_gaminc_rim_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute generalized incomplete gamma tables for riming&quot;&quot;&quot;</span>

    <span class="n">zrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
        <span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MAX</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;a factor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="si">}</span><span class="s2">, GAMINC * zrate = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">zrate</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">DS</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">generalized_incomplete_gamma</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">NUS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">BS</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span><span class="o">.</span><span class="n">ALPHAS</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_BOUND_MIN</span> <span class="o">*</span> <span class="n">zrate</span> <span class="o">*</span> <span class="n">j1</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGAMINC</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Value error while computing generalized_incomplete_gamma : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM1</span> <span class="o">=</span> <span class="n">GAMINC_RIM1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM2</span> <span class="o">=</span> <span class="n">GAMINC_RIM2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GAMINC_RIM4</span> <span class="o">=</span> <span class="n">GAMINC_RIM4</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>


</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../rain_ice_field_address/" class="btn btn-neutral float-left" title="Rain ice field address"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../xker_raccs/" class="btn btn-neutral float-right" title="Xker raccs">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../rain_ice_field_address/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../xker_raccs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
