============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.3.5, pluggy-1.5.0
rootdir: /home/maurinl/maurinl26/dwarf-p-ice3
configfile: pyproject.toml
plugins: Faker-37.0.0, devtools-0.12.2
collected 7 items

tests/repro/test_ice4_tendencies.py FFFFF.F                              [100%]

=================================== FAILURES ===================================
_________________ TestIce4Tendencies.test_ice4_derived_fields __________________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_derived_fields>

    def test_ice4_derived_fields(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_derived_fields_gt4py = compile_stencil(
            "ice4_derived_fields",
            gt4py_config,
            phyex_externals
        )
    
        t = 100 * np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rhodref = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        pres = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        ssi = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        ka = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        dv = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ai = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        cj = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rvt = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        zw = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
        t_gt4py = from_array(t, dtype=float, backend=BACKEND)
        rhodref_gt4py = from_array(rhodref, dtype=float, backend=BACKEND)
        pres_gt4py = from_array(pres, dtype=float, backend=BACKEND)
        ssi_gt4py = from_array(ssi, dtype=float, backend=BACKEND)
        ka_gt4py = from_array(ka, dtype=float, backend=BACKEND)
        dv_gt4py = from_array(dv, dtype=float, backend=BACKEND)
        ai_gt4py = from_array(ai, dtype=float, backend=BACKEND)
        cj_gt4py = from_array(cj, dtype=float, backend=BACKEND)
        rvt_gt4py = from_array(rvt, dtype=float, backend=BACKEND)
        zw_gt4py = from_array(zw, dtype=float, backend=BACKEND)
    
        ice4_derived_fields_gt4py(
            t=t_gt4py,
            rhodref=rhodref_gt4py,
            pres=pres_gt4py,
            ssi=ssi_gt4py,
            ka=ka_gt4py,
            ai=ai_gt4py,
            cj=cj_gt4py,
            rvt=rvt_gt4py,
            dv=dv,
            zw=zw_gt4py
        )
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_derived_fields(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            xalpi=phyex_externals["ALPI"],
            xbetai=phyex_externals["BETAI"],
            xgami=phyex_externals["GAMI"],
            xepsilo=phyex_externals["EPSILO"],
            xrv=phyex_externals["RV"],
            xci=phyex_externals["CI"],
            xlstt=phyex_externals["LSTT"],
            xcpv=phyex_externals["CPV"],
            xp00=phyex_externals["P00"],
            xscfac=phyex_externals["SCFAC"],
            xtt=phyex_externals["TT"],
            zt=t.ravel(),
            prvt=rvt.ravel(),
            ppres=pres.ravel(),
            prhodref=rhodref.ravel(),
            zzw=zw.ravel(),
            pssi=ssi.ravel(),
            zka=ka.ravel(),
            zai=ai.ravel(),
            zdv=dv.ravel(),
            zcj=cj.ravel()
        )
    
        zzw_out=result[0]
        pssi_out=result[1]
        zka_out=result[2]
        zai_out=result[3]
        zdv_out=result[4]
        zcj_out=result[5]
    
        logging.info(f"Mean zw_gt4py {zw_gt4py.mean()}")
        logging.info(f"Mean  zzw_out {zzw_out.mean()}")
        logging.info(f"Max rtol err zw {max(abs(zw_gt4py.ravel() - zzw_out) / abs(zzw_out))}")
    
        logging.info(f"Mean ssi_gt4py {ssi_gt4py.mean()}")
        logging.info(f"Mean  pssi_out {pssi_out.mean()}")
        logging.info(f"Max rtol err ssi {max(abs(ssi_gt4py.ravel() - pssi_out) / abs(pssi_out))}")
    
        logging.info(f"Mean ka_gt4py {ka_gt4py.mean()}")
        logging.info(f"Mean  zka_out {zka_out.mean()}")
        logging.info(f"Max rtol err ka {max(abs(ka_gt4py.ravel() - zka_out) / abs(zka_out))}")
    
        logging.info(f"Mean ai_gt4py {ai_gt4py.mean()}")
        logging.info(f"Mean  zai_out {zai_out.mean()}")
        logging.info(f"Max rtol err ai {max(abs(ai_gt4py.ravel() - zai_out) / abs(zai_out))}")
    
        logging.info(f"Mean dv_gt4py {dv_gt4py.mean()}")
        logging.info(f"Mean  zdv_out {zdv_out.mean()}")
        logging.info(f"Max rtol err dv {max(abs(dv_gt4py.ravel() - zdv_out) / abs(zdv_out))}")
    
        logging.info(f"Mean cj_gt4py {cj_gt4py.mean()}")
        logging.info(f"Mean  zcj_out {zcj_out.mean()}")
        logging.info(f"Max rtol err cj {max(abs(cj_gt4py.ravel() - zcj_out) / abs(zcj_out))}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
>       assert_allclose(pssi_out, ssi_gt4py.ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:868: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x72998b67d580>, array([          inf,           inf,           inf, .....ay([6.56217320e+262, 8.61761653e+064, 1.03457816e+054, ...,
       2.33842181e+014, 1.23570596e+024, 2.83884406e+105]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           x and y +inf location mismatch:
E            x: array([         inf,          inf,          inf, ..., 2.338428e+14,
E                  1.235716e+24,          inf], dtype=float32)
E            y: array([6.562173e+262, 8.617617e+064, 1.034578e+054, ..., 2.338422e+014,
E                  1.235706e+024, 2.838844e+105])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_derived_fields.m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_derived_fields/m_ice4_derived_fields__gtcpu_kfirst_5d34c69eea_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_derived_fields
INFO     root:test_ice4_tendencies.py:806 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:842 Mean zw_gt4py 7.44037014282666e-17
INFO     root:test_ice4_tendencies.py:843 Mean  zzw_out 7.440352628805045e-17
INFO     root:test_ice4_tendencies.py:844 Max rtol err zw inf
INFO     root:test_ice4_tendencies.py:846 Mean ssi_gt4py inf
INFO     root:test_ice4_tendencies.py:847 Mean  pssi_out inf
INFO     root:test_ice4_tendencies.py:848 Max rtol err ssi nan
INFO     root:test_ice4_tendencies.py:850 Mean ka_gt4py 0.007946845174513613
INFO     root:test_ice4_tendencies.py:851 Mean  zka_out 0.007946845144033432
INFO     root:test_ice4_tendencies.py:852 Max rtol err ka 4.904785775087038e-07
INFO     root:test_ice4_tendencies.py:854 Mean ai_gt4py inf
INFO     root:test_ice4_tendencies.py:855 Mean  zai_out inf
INFO     root:test_ice4_tendencies.py:856 Max rtol err ai nan
INFO     root:test_ice4_tendencies.py:858 Mean dv_gt4py 0.4999140615119138
INFO     root:test_ice4_tendencies.py:859 Mean  zdv_out 1.086745023727417
INFO     root:test_ice4_tendencies.py:860 Max rtol err dv 1522924358.0665348
INFO     root:test_ice4_tendencies.py:862 Mean cj_gt4py 280.0935841784223
INFO     root:test_ice4_tendencies.py:863 Mean  zcj_out 280.0935974121094
INFO     root:test_ice4_tendencies.py:864 Max rtol err cj 3.0702597250854563e-07
INFO     root:test_ice4_tendencies.py:866 Machine precision 2.220446049250313e-16
________________ TestIce4Tendencies.test_ice4_increment_update _________________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_increment_update>

    def test_ice4_increment_update(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_increment_update_gt4py = compile_stencil(
            "ice4_increment_update",
            gt4py_config,
            phyex_externals
        )
    
    
        lsfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
        lvfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        theta_increment = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rv_increment = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rc_increment = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rr_increment = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ri_increment = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rs_increment = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rg_increment = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rvheni_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rimltc_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rrhong_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rsrimcg_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
    
        lsfact_gt4py = from_array(lsfact, dtype=float, backend=BACKEND)
        lvfact_gt4py = from_array(lvfact, dtype=float, backend=BACKEND)
        theta_increment_gt4py = from_array(theta_increment, dtype=float, backend=BACKEND)
        rv_increment_gt4py = from_array(rv_increment, dtype=float, backend=BACKEND)
        rc_increment_gt4py = from_array(rc_increment, dtype=float, backend=BACKEND)
        rr_increment_gt4py = from_array(rr_increment, dtype=float, backend=BACKEND)
        ri_increment_gt4py = from_array(ri_increment, dtype=float, backend=BACKEND)
        rs_increment_gt4py = from_array(rs_increment, dtype=float, backend=BACKEND)
        rg_increment_gt4py = from_array(rg_increment, dtype=float, backend=BACKEND)
        rvheni_mr_gt4py = from_array(rvheni_mr, dtype=float, backend=BACKEND)
        rimltc_mr_gt4py = from_array(rimltc_mr, dtype=float, backend=BACKEND)
        rsrimcg_mr_gt4py = from_array(rsrimcg_mr, dtype=float, backend=BACKEND)
        rrhong_mr_gt4py = from_array(rrhong_mr, dtype=float, backend=BACKEND)
    
    
        ice4_increment_update_gt4py(
            lsfact=lsfact_gt4py,
            lvfact=lvfact_gt4py,
            theta_increment=theta_increment_gt4py,
            rv_increment=rv_increment_gt4py,
            rc_increment=rc_increment_gt4py,
            rr_increment=rr_increment_gt4py,
            ri_increment=ri_increment_gt4py,
            rs_increment=rs_increment_gt4py,
            rg_increment=rg_increment_gt4py,
            rimltc_mr=rimltc_mr_gt4py,
            rrhong_mr=rrhong_mr_gt4py,
            rsrimcg_mr=rsrimcg_mr_gt4py,
            rvheni_mr=rvheni_mr_gt4py
        )
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_increment_update(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            plsfact=lsfact.ravel(),
            plvfact=lvfact.ravel(),
            prvheni_mr=rvheni_mr.ravel(),
            primltc_mr=rimltc_mr.ravel(),
            prrhong_mr=rrhong_mr.ravel(),
            prsrimcg_mr=rsrimcg_mr.ravel(),
            pth_inst=theta_increment.ravel(),
            prv_inst=rv_increment.ravel(),
            prc_inst=rc_increment.ravel(),
            prr_inst=rr_increment.ravel(),
            pri_inst=ri_increment.ravel(),
            prs_inst=rs_increment.ravel(),
            prg_inst=rg_increment.ravel()
        )
    
        pth_inst_out=result[0]
        prv_inst_out=result[1]
        prc_inst_out=result[2]
        prr_inst_out=result[3]
        pri_inst_out=result[4]
        prs_inst_out=result[5]
        prg_inst_out=result[6]
    
        logging.info(f"Mean tht_incr_gt4py {theta_increment_gt4py.mean()}")
        logging.info(f"Mean   tht_inst_out {pth_inst_out.mean()}")
    
        logging.info(f"Mean rv_incr_gt4py {rv_increment_gt4py.mean()}")
        logging.info(f"Mean   rv_inst_out {prv_inst_out.mean()}")
    
        logging.info(f"Mean rct_incr_gt4py {rc_increment_gt4py.mean()}")
        logging.info(f"Mean   rct_inst_out {prc_inst_out.mean()}")
    
        logging.info(f"Mean rrt_incr_gt4py {rr_increment_gt4py.mean()}")
        logging.info(f"Mean   rrt_inst_out {prr_inst_out.mean()}")
    
        logging.info(f"Mean rit_incr_gt4py {ri_increment_gt4py.mean()}")
        logging.info(f"Mean   rit_inst_out {pri_inst_out.mean()}")
    
        logging.info(f"Mean rst_incr_gt4py {rs_increment_gt4py.mean()}")
        logging.info(f"Mean   rst_inst_out {prs_inst_out.mean()}")
    
        logging.info(f"Mean rit_incr_gt4py {rg_increment_gt4py.mean()}")
        logging.info(f"Mean   rit_inst_out {prg_inst_out.mean()}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
>       assert_allclose(pth_inst_out, theta_increment_gt4py.ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:700: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x72998789a480>, array([0.8249077 , 1.4434364 , 0.9512168 , ..., 0.7209...28090602], dtype=float32), array([0.82490774, 1.44343628, 0.95121682, ..., 0.72094008, 1.04228893,
       0.28090601]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           Mismatched elements: 166 / 37500 (0.443%)
E           Max absolute difference: 2.61972493e-07
E           Max relative difference: 9.54884483e-05
E            x: array([0.824908, 1.443436, 0.951217, ..., 0.72094 , 1.042289, 0.280906],
E                 dtype=float32)
E            y: array([0.824908, 1.443436, 0.951217, ..., 0.72094 , 1.042289, 0.280906])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:test_ice4_tendencies.py:528 With backend gt:cpu_kfirst
INFO     root:rain_ice_param.py:746 a factor 3.27, GAMINC * zrate = 0.12626001098748563
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_increment_update.m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_increment_update/m_ice4_increment_update__gtcpu_kfirst_92f9cf8922_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_increment_update
INFO     root:test_ice4_tendencies.py:648 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:677 Mean tht_incr_gt4py 0.7502589765909985
INFO     root:test_ice4_tendencies.py:678 Mean   tht_inst_out 0.7502589821815491
INFO     root:test_ice4_tendencies.py:680 Mean rv_incr_gt4py -0.0014052432224321446
INFO     root:test_ice4_tendencies.py:681 Mean   rv_inst_out -0.0014052431797608733
INFO     root:test_ice4_tendencies.py:683 Mean rct_incr_gt4py 1.0006551197741087
INFO     root:test_ice4_tendencies.py:684 Mean   rct_inst_out 1.000655174255371
INFO     root:test_ice4_tendencies.py:686 Mean rrt_incr_gt4py -0.001509363676008547
INFO     root:test_ice4_tendencies.py:687 Mean   rrt_inst_out -0.0015093638794496655
INFO     root:test_ice4_tendencies.py:689 Mean rit_incr_gt4py 0.5007657811720498
INFO     root:test_ice4_tendencies.py:690 Mean   rit_inst_out 0.500765860080719
INFO     root:test_ice4_tendencies.py:692 Mean rst_incr_gt4py 0.003436504838448691
INFO     root:test_ice4_tendencies.py:693 Mean   rst_inst_out 0.0034365050960332155
INFO     root:test_ice4_tendencies.py:695 Mean rit_incr_gt4py 1.4983695134209616
INFO     root:test_ice4_tendencies.py:696 Mean   rit_inst_out 1.4983694553375244
INFO     root:test_ice4_tendencies.py:698 Machine precision 2.220446049250313e-16
___________ TestIce4Tendencies.test_ice4_nucleation_post_processing ____________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_nucleation_post_processing>

    def test_ice4_nucleation_post_processing(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_nucleation_post_processing_gt4py = compile_stencil(
            "ice4_nucleation_post_processing",
            gt4py_config,
            phyex_externals
        )
    
    
        t = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
        exn = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lsfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        tht = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rvt = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rit = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rvheni_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
    
        t_gt4py = from_array(t, dtype=float, backend=BACKEND)
        exn_gt4py = from_array(exn, dtype=float, backend=BACKEND)
        lsfact_gt4py = from_array(lsfact, dtype=float, backend=BACKEND)
        tht_gt4py = from_array(tht, dtype=float, backend=BACKEND)
        rvt_gt4py = from_array(rvt, dtype=float, backend=BACKEND)
        rit_gt4py = from_array(rit, dtype=float, backend=BACKEND)
        rvheni_mr_gt4py = from_array(rvheni_mr, dtype=float, backend=BACKEND)
    
        ice4_nucleation_post_processing_gt4py(
            t=t_gt4py,
            exn=exn_gt4py,
            lsfact=lsfact_gt4py,
            tht=tht_gt4py,
            rvt=rvt_gt4py,
            rit=rit_gt4py,
            rvheni_mr=rvheni_mr_gt4py,
        )
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_nucleation_post_processing(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            plsfact=lsfact.ravel(),
            pexn=exn.ravel(),
            tht=tht.ravel(),
            prit=rit.ravel(),
            prvt=rvt.ravel(),
            zt=t.ravel(),
            rvheni_mr=rvheni_mr.ravel()
        )
    
        tht_out = result[0]
        rvt_out = result[1]
        rit_out = result[2]
        zt_out = result[3]
    
        logging.info(f"Mean tht_gt4py {tht_gt4py.mean()}")
        logging.info(f"Mean   tht_out {tht_out.mean()}")
    
        logging.info(f"Mean rit_gt4py {rit_gt4py.mean()}")
        logging.info(f"Mean   rit_out {rit_out.mean()}")
    
        logging.info(f"Mean rvt_gt4py {rvt_gt4py.mean()}")
        logging.info(f"Mean   rvt_out {rvt_out.mean()}")
    
        logging.info(f"Mean t_gt4py {t_gt4py.mean()}")
        logging.info(f"Mean  zt_out {zt_out.mean()}")
        logging.info(f"Max abs {abs(zt_out - t_gt4py.ravel())}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
        assert_allclose(tht_out, tht_gt4py[...].ravel(),  rtol=1e-6)
        assert_allclose(rit_out, rit_gt4py[...].ravel(),  rtol=1e-6)
        assert_allclose(zt_out, t_gt4py[...].ravel(),  rtol=1e-6)
>       assert_allclose(rvt_out, rvt_gt4py[...].ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:135: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x7299878e07c0>, array([-0.46384203,  0.69017744,  0.39990032, ...,  0....7 ], dtype=float32), array([-0.46384203,  0.69017744,  0.39990031, ...,  0.002704  ,
        0.34080278,  0.30154669]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           Mismatched elements: 973 / 37500 (2.59%)
E           Max absolute difference: 7.29901783e-08
E           Max relative difference: 0.00633882
E            x: array([-0.463842,  0.690177,  0.3999  , ...,  0.002704,  0.340803,
E                   0.301547], dtype=float32)
E            y: array([-0.463842,  0.690177,  0.3999  , ...,  0.002704,  0.340803,
E                   0.301547])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:test_ice4_tendencies.py:20 With backend gt:cpu_kfirst
INFO     root:rain_ice_param.py:746 a factor 3.27, GAMINC * zrate = 0.12626001098748563
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_nucleation_post_processing.m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing/m_ice4_nucleation_post_processing__gtcpu_kfirst_6e2b27952e_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_nucleation_post_processing
INFO     root:test_ice4_tendencies.py:97 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:117 Mean tht_gt4py 0.7521234391302701
INFO     root:test_ice4_tendencies.py:118 Mean   tht_out 0.7521234154701233
INFO     root:test_ice4_tendencies.py:120 Mean rit_gt4py 0.9983762941747324
INFO     root:test_ice4_tendencies.py:121 Mean   rit_out 0.9983762502670288
INFO     root:test_ice4_tendencies.py:123 Mean rvt_gt4py -0.0008367238457545719
INFO     root:test_ice4_tendencies.py:124 Mean   rvt_out -0.0008367237751372159
INFO     root:test_ice4_tendencies.py:126 Mean t_gt4py 0.37749323923992734
INFO     root:test_ice4_tendencies.py:127 Mean  zt_out 0.3774932622909546
INFO     root:test_ice4_tendencies.py:128 Max abs [7.42682305e-10 2.86407430e-09 1.79155932e-08 ... 1.42933326e-09
 2.09036233e-09 3.23817431e-10]
INFO     root:test_ice4_tendencies.py:130 Machine precision 2.220446049250313e-16
_____________ TestIce4Tendencies.test_ice4_rimltc_post_processing ______________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_rimltc_post_processing>

    def test_ice4_rimltc_post_processing(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_rimltc_post_processing_gt4py = compile_stencil(
            "ice4_rimltc_post_processing",
            gt4py_config,
            phyex_externals
        )
    
    
        t = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
        exn = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lsfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lvfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rimltc_mr = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        tht = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rct = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rit = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
    
        t_gt4py = from_array(t, dtype=float, backend=BACKEND)
        exn_gt4py = from_array(exn, dtype=float, backend=BACKEND)
        lsfact_gt4py = from_array(lsfact, dtype=float, backend=BACKEND)
        lvfact_gt4py = from_array(lvfact, dtype=float, backend=BACKEND)
        tht_gt4py = from_array(tht, dtype=float, backend=BACKEND)
        rimltc_mr_gt4py = from_array(rimltc_mr, dtype=float, backend=BACKEND)
        rct_gt4py = from_array(rct, dtype=float, backend=BACKEND)
        rit_gt4py = from_array(rit, dtype=float, backend=BACKEND)
    
        ice4_rimltc_post_processing_gt4py(
            t=t_gt4py,
            exn=exn_gt4py,
            lsfact=lsfact_gt4py,
            lvfact=lvfact_gt4py,
            rimltc_mr=rimltc_mr_gt4py,
            tht=tht_gt4py,
            rct=rct_gt4py,
            rit=rit_gt4py
        )
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_rimltc_post_processing(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            plsfact=lsfact.ravel(),
            plvfact=lvfact.ravel(),
            pexn=exn.ravel(),
            primltc_mr=rimltc_mr.ravel(),
            ptht=tht.ravel(),
            pt=t.ravel(),
            prit=rit.ravel(),
            prct=rct.ravel()
        )
    
        tht_out = result[0]
        t_out = result[1]
        rct_out = result[2]
        rit_out = result[3]
    
        logging.info(f"Mean tht_gt4py {tht_gt4py.mean()}")
        logging.info(f"Mean tht_out {tht_out.mean()}")
    
        logging.info(f"Mean t_gt4py {t_gt4py.mean()}")
        logging.info(f"Mean t_out {t_out.mean()}")
    
        logging.info(f"Mean rct_gt4py {rct_gt4py.mean()}")
        logging.info(f"Mean rct_out {rct_out.mean()}")
    
        logging.info(f"Mean rit_gt4py {rit_gt4py.mean()}")
        logging.info(f"Mean rit_out {rit_out.mean()}")
    
        logging.info(f"Ravel ordering F {tht_out[0]}, {tht_gt4py.ravel(order="F")[0]}")
        logging.info(f"Ravel ordering C {tht_out[0]}, {tht_gt4py.ravel(order="C")[0]}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
>       assert_allclose(tht_out, tht_gt4py[...].ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:520: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x72998b638900>, array([0.6646167 , 0.3610752 , 0.39893824, ..., 0.8785...46408674], dtype=float32), array([0.66461672, 0.36107517, 0.39893822, ..., 0.87856564, 0.5583072 ,
       0.46408677]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           Mismatched elements: 378 / 37500 (1.01%)
E           Max absolute difference: 1.76024176e-07
E           Max relative difference: 0.00131239
E            x: array([0.664617, 0.361075, 0.398938, ..., 0.878566, 0.558307, 0.464087],
E                 dtype=float32)
E            y: array([0.664617, 0.361075, 0.398938, ..., 0.878566, 0.558307, 0.464087])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:test_ice4_tendencies.py:398 With backend gt:cpu_kfirst
INFO     root:rain_ice_param.py:746 a factor 3.27, GAMINC * zrate = 0.12626001098748563
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_rimltc_post_processing.m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing/m_ice4_rimltc_post_processing__gtcpu_kfirst_fb9bd3365b_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rimltc_post_processing
INFO     root:test_ice4_tendencies.py:482 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:503 Mean tht_gt4py 0.5007910566041396
INFO     root:test_ice4_tendencies.py:504 Mean tht_out 0.5007910132408142
INFO     root:test_ice4_tendencies.py:506 Mean t_gt4py 0.25083183009317767
INFO     root:test_ice4_tendencies.py:507 Mean t_out 0.25083181262016296
INFO     root:test_ice4_tendencies.py:509 Mean rct_gt4py 0.998094614832837
INFO     root:test_ice4_tendencies.py:510 Mean rct_out 0.9980945587158203
INFO     root:test_ice4_tendencies.py:512 Mean rit_gt4py 0.0017612284318858278
INFO     root:test_ice4_tendencies.py:513 Mean rit_out 0.0017612286610528827
INFO     root:test_ice4_tendencies.py:515 Ravel ordering F 0.6646167039871216, 0.6646167231232899
INFO     root:test_ice4_tendencies.py:516 Ravel ordering C 0.6646167039871216, 0.6646167231232899
INFO     root:test_ice4_tendencies.py:518 Machine precision 2.220446049250313e-16
_____________ TestIce4Tendencies.test_ice4_rrhong_post_processing ______________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_rrhong_post_processing>

    def test_ice4_rrhong_post_processing(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_rrhong_post_processing_gt4py = compile_stencil(
            "ice4_rrhong_post_processing",
            gt4py_config,
            phyex_externals
        )
    
    
        t = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
        exn = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lsfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lvfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        tht = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rrt = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rgt = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rrhong_mr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
    
    
        t_gt4py = from_array(t, dtype=float, backend=BACKEND)
        exn_gt4py = from_array(exn, dtype=float, backend=BACKEND)
        lsfact_gt4py = from_array(lsfact, dtype=float, backend=BACKEND)
        lvfact_gt4py = from_array(lvfact, dtype=float, backend=BACKEND)
        tht_gt4py = from_array(tht, dtype=float, backend=BACKEND)
        rrt_gt4py = from_array(rrt, dtype=float, backend=BACKEND)
        rgt_gt4py = from_array(rgt, dtype=float, backend=BACKEND)
        rrhong_mr_gt4py = from_array(rrhong_mr, dtype=float, backend=BACKEND)
    
        ice4_rrhong_post_processing_gt4py(
            t=t_gt4py,
            exn=exn_gt4py,
            lsfact=lsfact_gt4py,
            lvfact=lvfact_gt4py,
            tht=tht_gt4py,
            rrt=rrt_gt4py,
            rgt=rgt_gt4py,
            rrhong_mr=rrhong_mr_gt4py,
        )
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_rrhong_post_processing(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            plsfact=lsfact.ravel(),
            plvfact=lvfact.ravel(),
            pexn=exn.ravel(),
            prrhong_mr=rrhong_mr.ravel(),
            ptht=tht.ravel(),
            pt=t.ravel(),
            prrt=rrt.ravel(),
            prgt=rgt.ravel()
        )
    
        tht_out = result[0]
        t_out = result[1]
        rrt_out = result[2]
        rgt_out = result[3]
    
        logging.info(f"Mean tht_gt4py {tht_gt4py.mean()}")
        logging.info(f"Mean tht_out {tht_out.mean()}")
    
        logging.info(f"Mean t_gt4py {t_gt4py.mean()}")
        logging.info(f"Mean t_out {t_out.mean()}")
    
        logging.info(f"Mean rrt_gt4py {rrt_gt4py.mean()}")
        logging.info(f"Mean rrt_out {rrt_out.mean()}")
    
        logging.info(f"Mean rgt_gt4py {rgt_gt4py.mean()}")
        logging.info(f"Mean rgt_out {rgt_out.mean()}")
    
        logging.info(f"Ravel ordering F {tht_out[0]}, {tht_gt4py.ravel(order="F")[0]}")
        logging.info(f"Ravel ordering C {tht_out[0]}, {tht_gt4py.ravel(order="C")[0]}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
>       assert_allclose(tht_out, tht_gt4py[...].ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:262: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x729987acda80>, array([ 0.8412488 ,  0.92263025,  0.4908983 , ...,  0....44], dtype=float32), array([ 0.84124878,  0.92263028,  0.49089829, ...,  0.70606512,
        1.15429518, -0.00460241]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           Mismatched elements: 380 / 37500 (1.01%)
E           Max absolute difference: 1.47952714e-07
E           Max relative difference: 0.00060856
E            x: array([ 0.841249,  0.92263 ,  0.490898, ...,  0.706065,  1.154295,
E                  -0.004602], dtype=float32)
E            y: array([ 0.841249,  0.92263 ,  0.490898, ...,  0.706065,  1.154295,
E                  -0.004602])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:test_ice4_tendencies.py:140 With backend gt:cpu_kfirst
INFO     root:rain_ice_param.py:746 a factor 3.27, GAMINC * zrate = 0.12626001098748563
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_rrhong_post_processing.m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing/m_ice4_rrhong_post_processing__gtcpu_kfirst_c783f3daf1_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_rrhong_post_processing
INFO     root:test_ice4_tendencies.py:224 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:245 Mean tht_gt4py 0.49924595357403323
INFO     root:test_ice4_tendencies.py:246 Mean tht_out 0.49924594163894653
INFO     root:test_ice4_tendencies.py:248 Mean t_gt4py 0.24911111042998
INFO     root:test_ice4_tendencies.py:249 Mean t_out 0.2491111159324646
INFO     root:test_ice4_tendencies.py:251 Mean rrt_gt4py 0.0035490332368378744
INFO     root:test_ice4_tendencies.py:252 Mean rrt_out 0.003549033310264349
INFO     root:test_ice4_tendencies.py:254 Mean rgt_gt4py 0.9990187299465537
INFO     root:test_ice4_tendencies.py:255 Mean rgt_out 0.9990187287330627
INFO     root:test_ice4_tendencies.py:257 Ravel ordering F 0.8412488102912903, 0.8412487816443893
INFO     root:test_ice4_tendencies.py:258 Ravel ordering C 0.8412488102912903, 0.8412487816443893
INFO     root:test_ice4_tendencies.py:260 Machine precision 2.220446049250313e-16
_____________ TestIce4Tendencies.test_ice4_total_tendencies_update _____________

self = <tests.repro.test_ice4_tendencies.TestIce4Tendencies testMethod=test_ice4_total_tendencies_update>

    def test_ice4_total_tendencies_update(self):
    
        logging.info(f"With backend {BACKEND}")
        gt4py_config = GT4PyConfig(
            backend=BACKEND, rebuild=REBUILD, validate_args=VALIDATE_ARGS, verbose=True
        )
    
        phyex_externals = Phyex("AROME").to_externals()
        ice4_total_tendencies_update = compile_stencil(
            "ice4_total_tendencies_update",
            gt4py_config,
            phyex_externals
        )
    
        lsfact = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        lvfact = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        th_tnd = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rv_tnd = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
        rc_tnd = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rr_tnd = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ri_tnd = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rs_tnd = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rg_tnd = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rchoni = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rvdeps = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        riaggs = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        riauts = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rvdepg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcautr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcaccr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rrevav = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcberi = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rsmltg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcmltsr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rraccss = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rraccsg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rsaccrg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcrimss = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcrimsg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rsrimcg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ricfrrg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rrcfrig = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ricfrr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcwetg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        riwetg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rrwetg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rswetg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rcdryg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        ridryg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rrdryg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rsdryg = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rgmltr = np.array(
                np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
            )
        rwetgh = np.array(
            np.random.rand(SHAPE[0], SHAPE[1], SHAPE[2]),
                dtype=float,
                order="F",
        )
    
    
        lsfact_gt4py = from_array(lsfact, dtype=float, backend=BACKEND)
        lvfact_gt4py = from_array(lvfact, dtype=float, backend=BACKEND)
        th_tnd_gt4py = from_array(th_tnd, dtype=float, backend=BACKEND)
        rv_tnd_gt4py = from_array(rv_tnd, dtype=float, backend=BACKEND)
        rc_tnd_gt4py = from_array(rc_tnd, dtype=float, backend=BACKEND)
        rr_tnd_gt4py = from_array(rr_tnd, dtype=float, backend=BACKEND)
        ri_tnd_gt4py = from_array(ri_tnd, dtype=float, backend=BACKEND)
        rs_tnd_gt4py = from_array(rs_tnd, dtype=float, backend=BACKEND)
        rg_tnd_gt4py = from_array(rg_tnd, dtype=float, backend=BACKEND)
    
        rchoni_gt4py = from_array(rchoni, dtype=float, backend=BACKEND)
        rvdeps_gt4py = from_array(rvdeps, dtype=float, backend=BACKEND)
        riaggs_gt4py = from_array(riaggs, dtype=float, backend=BACKEND)
        riauts_gt4py = from_array(riauts, dtype=float, backend=BACKEND)
        rvdepg_gt4py = from_array(rvdepg, dtype=float, backend=BACKEND)
        rcautr_gt4py = from_array(rcautr, dtype=float, backend=BACKEND)
        rcaccr_gt4py = from_array(rcaccr, dtype=float, backend=BACKEND)
        rrevav_gt4py = from_array(rrevav, dtype=float, backend=BACKEND)
        rcberi_gt4py = from_array(rcberi, dtype=float, backend=BACKEND)
        rsmltg_gt4py = from_array(rsmltg, dtype=float, backend=BACKEND)
        rcmltsr_gt4py = from_array(rcmltsr, dtype=float, backend=BACKEND)
        rraccss_gt4py = from_array(rraccss, dtype=float, backend=BACKEND)
        rraccsg_gt4py = from_array(rraccsg, dtype=float, backend=BACKEND)
        rsaccrg_gt4py = from_array(rsaccrg, dtype=float, backend=BACKEND)
        rcrimss_gt4py = from_array(rcrimss, dtype=float, backend=BACKEND)
        rcrimsg_gt4py = from_array(rcrimsg, dtype=float, backend=BACKEND)
        rsrimcg_gt4py = from_array(rsrimcg, dtype=float, backend=BACKEND)
        ricfrrg_gt4py = from_array(ricfrrg, dtype=float, backend=BACKEND)
        rrcfrig_gt4py = from_array(rrcfrig, dtype=float, backend=BACKEND)
        ricfrr_gt4py = from_array(ricfrr, dtype=float, backend=BACKEND)
        rcwetg_gt4py = from_array(rcwetg, dtype=float, backend=BACKEND)
        riwetg_gt4py = from_array(riwetg, dtype=float, backend=BACKEND)
        rrwetg_gt4py = from_array(rrwetg, dtype=float, backend=BACKEND)
        rswetg_gt4py = from_array(rswetg, dtype=float, backend=BACKEND)
        rcdryg_gt4py = from_array(rcdryg, dtype=float, backend=BACKEND)
        ridryg_gt4py = from_array(ridryg, dtype=float, backend=BACKEND)
        rrdryg_gt4py = from_array(rrdryg, dtype=float, backend=BACKEND)
        rsdryg_gt4py = from_array(rsdryg, dtype=float, backend=BACKEND)
        rgmltr_gt4py = from_array(rgmltr, dtype=float, backend=BACKEND)
        rwetgh_gt4py = from_array(rwetgh, dtype=float, backend=BACKEND)
    
        ice4_total_tendencies_update(
            lsfact=lsfact_gt4py,
            lvfact=lvfact_gt4py,
            th_tnd=th_tnd_gt4py,
            rv_tnd=rv_tnd_gt4py,
            rc_tnd=rc_tnd_gt4py,
            rr_tnd=rr_tnd_gt4py,
            ri_tnd=ri_tnd_gt4py,
            rs_tnd=rs_tnd_gt4py,
            rg_tnd=rg_tnd_gt4py,
            rchoni=rchoni_gt4py,
            rvdeps=rvdeps_gt4py,
            riaggs=riaggs_gt4py,
            riauts=riauts_gt4py,
            rvdepg=rvdepg_gt4py,
            rcautr=rcautr_gt4py,
            rcaccr=rcaccr_gt4py,
            rrevav=rrevav_gt4py,
            rcberi=rcberi_gt4py,
            rsmltg=rsmltg_gt4py,
            rcmltsr=rcmltsr_gt4py,
            rraccss=rraccss_gt4py,
            rraccsg=rraccsg_gt4py,
            rsaccrg=rsaccrg_gt4py,
            rcrimss=rcrimss_gt4py,
            rcrimsg=rcrimsg_gt4py,
            rsrimcg=rsrimcg_gt4py,
            ricfrrg=ricfrrg_gt4py,
            rrcfrig=rrcfrig_gt4py,
            ricfrr=ricfrr_gt4py,
            rcwetg=rcwetg_gt4py,
            riwetg=riwetg_gt4py,
            rrwetg=rrwetg_gt4py,
            rswetg=rswetg_gt4py,
            rcdryg=rcdryg_gt4py,
            ridryg=ridryg_gt4py,
            rrdryg=rrdryg_gt4py,
            rsdryg=rsdryg_gt4py,
            rgmltr=rgmltr_gt4py,
            rwetgh=rwetgh_gt4py
        )
    
    
    
        fortran_script = "mode_ice4_tendencies.F90"
        current_directory = Path.cwd()
        root_directory = current_directory
        stencils_directory = Path(
            root_directory, "src", "ice3_gt4py", "stencils_fortran"
        )
        script_path = Path(stencils_directory, fortran_script)
    
        logging.info(f"Fortran script path {script_path}")
        fortran_script = fmodpy.fimport(script_path)
    
        result = fortran_script.mode_ice4_tendencies.ice4_total_tendencies_update(
            kproma=SHAPE[0]*SHAPE[1]*SHAPE[2],
            ksize=SHAPE[0]*SHAPE[1]*SHAPE[2],
            plsfact=lsfact.ravel(),
            plvfact=lvfact.ravel(),
            pth_tnd=th_tnd.ravel(),
            prv_tnd=rv_tnd.ravel(),
            prc_tnd=rc_tnd.ravel(),
            prr_tnd=rr_tnd.ravel(),
            pri_tnd=ri_tnd.ravel(),
            prs_tnd=rs_tnd.ravel(),
            prg_tnd=rg_tnd.ravel(),
            rchoni=rchoni.ravel(),
            rvdeps=rvdeps.ravel(),
            riaggs=riaggs.ravel(),
            riauts=riauts.ravel(),
            rvdepg=rvdepg.ravel(),
            rcautr=rcautr.ravel(),
            rcaccr=rcaccr.ravel(),
            rrevav=rrevav.ravel(),
            rcberi=rcberi.ravel(),
            rsmltg=rsmltg.ravel(),
            rcmltsr=rcmltsr.ravel(),
            rraccss=rraccss.ravel(),
            rraccsg=rraccsg.ravel(),
            rsaccrg=rsaccrg.ravel(),
            rcrimss=rcrimss.ravel(),
            rcrimsg=rcrimsg.ravel(),
            rsrimcg=rsrimcg.ravel(),
            ricfrrg=ricfrrg.ravel(),
            rrcfrig=rrcfrig.ravel(),
            ricfrr=ricfrr.ravel(),
            rcwetg=rcwetg.ravel(),
            riwetg=riwetg.ravel(),
            rrwetg=rrwetg.ravel(),
            rswetg=rswetg.ravel(),
            rcdryg=rcdryg.ravel(),
            ridryg=ridryg.ravel(),
            rrdryg=rrdryg.ravel(),
            rsdryg=rsdryg.ravel(),
            rgmltr=rgmltr.ravel(),
            rwetgh=rwetgh.ravel(),
            )
    
        pth_tnd_out = result[0]
        prv_tnd_out = result[1]
        prc_tnd_out = result[2]
        prr_tnd_out = result[3]
        pri_tnd_out = result[4]
        prs_tnd_out = result[5]
        prg_tnd_out = result[6]
    
        logging.info("Test ice4 total tendencies")
        logging.info(f"Mean th_tnd_gt4py {th_tnd_gt4py.mean()}")
        logging.info(f"Mean th_tnd_out {pth_tnd_out.mean()}")
        logging.info(f"Max rtol err th_tnd {max(abs(th_tnd_gt4py.ravel() - pth_tnd_out) / abs(pth_tnd_out))}")
    
        logging.info(f"Mean rv_tnd_gt4py {rv_tnd_gt4py.mean()}")
        logging.info(f"Mean rv_tnd_out {prv_tnd_out.mean()}")
        logging.info(f"Max rtol err rv_tnd {max(abs(rv_tnd_gt4py.ravel() - prv_tnd_out) / abs(prv_tnd_out))}")
    
    
        logging.info(f"Mean rc_tnd_gt4py {rc_tnd_gt4py.mean()}")
        logging.info(f"Mean prc_tnd_out {prc_tnd_out.mean()}")
        logging.info(f"Max rtol err rc_tnd {max(abs(rc_tnd_gt4py.ravel() - prc_tnd_out) / abs(prc_tnd_out))}")
    
        logging.info(f"Mean rr_tnd_gt4py {rr_tnd_gt4py.mean()}")
        logging.info(f"Mean prr_tnd_out {prr_tnd_out.mean()}")
        logging.info(f"Max rtol err rr {max(abs(rr_tnd_gt4py.ravel() - prr_tnd_out) / abs(prr_tnd_out))}")
    
        logging.info(f"Mean ri_tnd_gt4py {ri_tnd_gt4py.mean()}")
        logging.info(f"Mean pri_tnd_out {pri_tnd_out.mean()}")
        logging.info(f"Max rtol err ri_tnd {max(abs(ri_tnd_gt4py.ravel() - pri_tnd_out) / abs(pri_tnd_out))}")
    
        logging.info(f"Mean rs_tnd_gt4py {rs_tnd_gt4py.mean()}")
        logging.info(f"Mean prs_tnd_out {prs_tnd_out.mean()}")
        logging.info(f"Max rtol err rs_tnd {max(abs(rs_tnd_gt4py.ravel() - prs_tnd_out) / abs(prs_tnd_out))}")
    
        logging.info(f"Mean rg_tnd_gt4py {rg_tnd_gt4py.mean()}")
        logging.info(f"Mean prg_tnd_out {prg_tnd_out.mean()}")
        logging.info(f"Max rtol err rg_tnd {max(abs(rg_tnd_gt4py.ravel() - prg_tnd_out) / abs(prg_tnd_out))}")
    
        logging.info(f"Machine precision {np.finfo(float).eps}")
    
>       assert_allclose(pth_tnd_out, th_tnd_gt4py.ravel(),  rtol=1e-6)

tests/repro/test_ice4_tendencies.py:1421: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x72998b7abf60>, array([ 0.7151662, -0.2719054,  1.7311592, ..., -1.450...13], dtype=float32), array([ 0.71516639, -0.27190555,  1.73115912, ..., -1.45071974,
        0.61778315,  1.63580143]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-06, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-06, atol=0
E           
E           Mismatched elements: 1009 / 37500 (2.69%)
E           Max absolute difference: 1.24261754e-06
E           Max relative difference: 0.00150362
E            x: array([ 0.715166, -0.271905,  1.731159, ..., -1.45072 ,  0.617783,
E                   1.635801], dtype=float32)
E            y: array([ 0.715166, -0.271906,  1.731159, ..., -1.45072 ,  0.617783,
E                   1.635801])

/usr/lib/python3.12/contextlib.py:81: AssertionError
------------------------------ Captured log call -------------------------------
INFO     root:test_ice4_tendencies.py:1032 With backend gt:cpu_kfirst
INFO     root:rain_ice_param.py:746 a factor 3.27, GAMINC * zrate = 0.12626001098748563
INFO     root:dist.py:1018 running build_ext
INFO     root:build_ext.py:545 building '_GT_.ifs_physics_common.framework.stencil.ice4_total_tendencies_update.m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext' extension
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -fPIC -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/pybind11/include -I/usr/local/include -I/home/maurinl/maurinl26/dwarf-p-ice3/.venv/include -I/usr/include/python3.12 -c .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/bindings.cpp -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/bindings.o -std=c++17 -ftemplate-depth=1024 -fvisibility=hidden -fPIC -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gridtools_cpp/data/include -isystem/usr/local/include -DBOOST_PP_VARIADICS -O3 -DNDEBUG -isystem/home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/dace/runtime/include -fopenmp
INFO     root:spawn.py:77 x86_64-linux-gnu-g++ -fno-strict-overflow -Wsign-compare -Wall -shared -Wl,-O1 -Wl,-Bsymbolic-functions .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/bindings.o -L/usr/lib/x86_64-linux-gnu -o .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext.cpython-312-x86_64-linux-gnu.so -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp -O3 -DNDEBUG -fopenmp
INFO     root:file_util.py:130 copying .gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext_BUILD/_GT_/ifs_physics_common/framework/stencil/ice4_total_tendencies_update/m_ice4_total_tendencies_update__gtcpu_kfirst_6a31fd0d10_pyext.cpython-312-x86_64-linux-gnu.so -> /home/maurinl/maurinl26/dwarf-p-ice3/.gt_cache/py312_1013/gtcpu_kfirst/ifs_physics_common/framework/stencil/ice4_total_tendencies_update
INFO     root:test_ice4_tendencies.py:1334 Fortran script path /home/maurinl/maurinl26/dwarf-p-ice3/src/ice3_gt4py/stencils_fortran/mode_ice4_tendencies.F90
INFO     root:test_ice4_tendencies.py:1389 Test ice4 total tendencies
INFO     root:test_ice4_tendencies.py:1390 Mean th_tnd_gt4py 0.7825635134784593
INFO     root:test_ice4_tendencies.py:1391 Mean th_tnd_out 0.7825635075569153
INFO     root:test_ice4_tendencies.py:1392 Max rtol err th_tnd 0.001501366096919476
INFO     root:test_ice4_tendencies.py:1394 Mean rv_tnd_gt4py -0.0004962305943827012
INFO     root:test_ice4_tendencies.py:1395 Mean rv_tnd_out -0.000496230146382004
INFO     root:test_ice4_tendencies.py:1396 Max rtol err rv_tnd 0.0006569847361367825
INFO     root:test_ice4_tendencies.py:1399 Mean rc_tnd_gt4py -3.9947911887851597
INFO     root:test_ice4_tendencies.py:1400 Mean prc_tnd_out -3.994791269302368
INFO     root:test_ice4_tendencies.py:1401 Max rtol err rc_tnd 1.9616732923199374e-07
INFO     root:test_ice4_tendencies.py:1403 Mean rr_tnd_gt4py 0.00013929527825357467
INFO     root:test_ice4_tendencies.py:1404 Mean prr_tnd_out 0.0001392957492498681
INFO     root:test_ice4_tendencies.py:1405 Max rtol err rr 0.006502996825504851
INFO     root:test_ice4_tendencies.py:1407 Mean ri_tnd_gt4py -1.5015094672246099
INFO     root:test_ice4_tendencies.py:1408 Mean pri_tnd_out -1.501509428024292
INFO     root:test_ice4_tendencies.py:1409 Max rtol err ri_tnd 0.0002494801238018602
INFO     root:test_ice4_tendencies.py:1411 Mean rs_tnd_gt4py 0.5014772714052184
INFO     root:test_ice4_tendencies.py:1412 Mean prs_tnd_out 0.5014773011207581
INFO     root:test_ice4_tendencies.py:1413 Max rtol err rs_tnd 0.0035920390840043725
INFO     root:test_ice4_tendencies.py:1415 Mean rg_tnd_gt4py 7.493428684547843
INFO     root:test_ice4_tendencies.py:1416 Mean prg_tnd_out 7.4934282302856445
INFO     root:test_ice4_tendencies.py:1417 Max rtol err rg_tnd 3.498598559134693e-07
INFO     root:test_ice4_tendencies.py:1419 Machine precision 2.220446049250313e-16
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/gt4py/cartesian/frontend/gtscript_frontend.py:104
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/frontend/gtscript_frontend.py:104: DeprecationWarning: ast.Ellipsis is deprecated and will be removed in Python 3.14; use ast.Constant instead
    node: Union[ast.Ellipsis, ast.Slice, ast.Subscript, ast.Constant],

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/frontend/gtscript_frontend.py:110: DeprecationWarning: ast.Ellipsis is deprecated and will be removed in Python 3.14; use ast.Constant instead
    if isinstance(node, ast.Ellipsis):

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/setuptools/command/easy_install.py:41: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/stencil_object.py:584: UserWarning: The layout of the field 'dv' is not recommended for this backend.This may lead to performance degradation. Please consider using theprovided allocators in `gt4py.storage`.
    self._validate_args(array_infos, parameter_args, domain, origin)

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/fmodpy/fmodpy.py:604: DeprecationWarning: 'pkgutil.get_loader' is deprecated and slated for removal in Python 3.14; use importlib.util.find_spec() instead
    package = pkgutil.get_loader(module_name)

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /usr/lib/python3.12/pkgutil.py:291: DeprecationWarning: 'pkgutil.find_loader' is deprecated and slated for removal in Python 3.14; use importlib.util.find_spec() instead
    return find_loader(fullname)

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:517: UserWarning: The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:526: UserWarning: The provided argument 'prvt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prvt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:535: UserWarning: The provided argument 'ppres' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ppres' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:544: UserWarning: The provided argument 'prhodref' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prhodref' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:555: UserWarning: The provided argument 'zzw' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zzw' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:566: UserWarning: The provided argument 'pssi' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pssi' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:577: UserWarning: The provided argument 'zka' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zka' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:588: UserWarning: The provided argument 'zai' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zai' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:599: UserWarning: The provided argument 'zdv' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zdv' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:610: UserWarning: The provided argument 'zcj' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zcj' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/tests/repro/test_ice4_tendencies.py:844: RuntimeWarning: divide by zero encountered in divide
    logging.info(f"Max rtol err zw {max(abs(zw_gt4py.ravel() - zzw_out) / abs(zzw_out))}")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/tests/repro/test_ice4_tendencies.py:844: RuntimeWarning: invalid value encountered in divide
    logging.info(f"Max rtol err zw {max(abs(zw_gt4py.ravel() - zzw_out) / abs(zzw_out))}")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/tests/repro/test_ice4_tendencies.py:848: RuntimeWarning: invalid value encountered in subtract
    logging.info(f"Max rtol err ssi {max(abs(ssi_gt4py.ravel() - pssi_out) / abs(pssi_out))}")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/tests/repro/test_ice4_tendencies.py:848: RuntimeWarning: invalid value encountered in divide
    logging.info(f"Max rtol err ssi {max(abs(ssi_gt4py.ravel() - pssi_out) / abs(pssi_out))}")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
  /home/maurinl/maurinl26/dwarf-p-ice3/tests/repro/test_ice4_tendencies.py:856: RuntimeWarning: invalid value encountered in subtract
    logging.info(f"Max rtol err ai {max(abs(ai_gt4py.ravel() - zai_out) / abs(zai_out))}")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/frontend/gtscript_frontend.py:580: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
    if not isinstance(node.value, (ast.Constant, ast.Str)):

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:348: UserWarning: The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:357: UserWarning: The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:366: UserWarning: The provided argument 'prvheni_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prvheni_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:375: UserWarning: The provided argument 'primltc_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'primltc_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:384: UserWarning: The provided argument 'prrhong_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prrhong_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:393: UserWarning: The provided argument 'prsrimcg_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prsrimcg_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:402: UserWarning: The provided argument 'pth_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pth_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:411: UserWarning: The provided argument 'prv_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prv_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:420: UserWarning: The provided argument 'prc_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prc_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:429: UserWarning: The provided argument 'prr_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prr_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:438: UserWarning: The provided argument 'pri_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pri_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:447: UserWarning: The provided argument 'prs_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prs_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:456: UserWarning: The provided argument 'prg_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prg_inst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:82: UserWarning: The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:91: UserWarning: The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:100: UserWarning: The provided argument 'rvheni_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rvheni_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:109: UserWarning: The provided argument 'tht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'tht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:118: UserWarning: The provided argument 'prvt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prvt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:127: UserWarning: The provided argument 'prit' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prit' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:138: UserWarning: The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:257: UserWarning: The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:266: UserWarning: The provided argument 'primltc_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'primltc_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:275: UserWarning: The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:284: UserWarning: The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:293: UserWarning: The provided argument 'ptht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ptht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:302: UserWarning: The provided argument 'pt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:311: UserWarning: The provided argument 'prct' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prct' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:320: UserWarning: The provided argument 'prit' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prit' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:166: UserWarning: The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pexn' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:175: UserWarning: The provided argument 'prrhong_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prrhong_mr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:184: UserWarning: The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:193: UserWarning: The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:202: UserWarning: The provided argument 'ptht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ptht' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:211: UserWarning: The provided argument 'pt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:220: UserWarning: The provided argument 'prrt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prrt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:229: UserWarning: The provided argument 'prgt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prgt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/frontend/gtscript_frontend.py:602: DeprecationWarning: stencil ice4_slope_parameters, line 52, column 8: compile-time if condition via __INLINED deprecated
    warnings.warn(  # noqa: B028 [no-explicit-stacklevel]

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/.venv/lib/python3.12/site-packages/gt4py/cartesian/utils/meta.py:312: DeprecationWarning: Attribute n is deprecated and will be removed in Python 3.14; use value instead
    return node.n

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:677: UserWarning: The provided argument 'prrt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prrt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:686: UserWarning: The provided argument 'prhodref' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prhodref' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:695: UserWarning: The provided argument 'prst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prst' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:704: UserWarning: The provided argument 'prgt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prgt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:713: UserWarning: The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zt' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:724: UserWarning: The provided argument 'zlbdar' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zlbdar' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:735: UserWarning: The provided argument 'zlbdar_rf' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zlbdar_rf' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:746: UserWarning: The provided argument 'zlbdas' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zlbdas' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_slope_parameters
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:757: UserWarning: The provided argument 'zlbdag' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'zlbdag' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:785: UserWarning: The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plsfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:794: UserWarning: The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'plvfact' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:803: UserWarning: The provided argument 'pth_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pth_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:812: UserWarning: The provided argument 'prv_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prv_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:821: UserWarning: The provided argument 'prc_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prc_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:830: UserWarning: The provided argument 'prr_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prr_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:839: UserWarning: The provided argument 'pri_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'pri_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:848: UserWarning: The provided argument 'prs_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prs_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:857: UserWarning: The provided argument 'prg_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'prg_tnd' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:866: UserWarning: The provided argument 'rvdepg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rvdepg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:875: UserWarning: The provided argument 'rchoni' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rchoni' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:884: UserWarning: The provided argument 'rvdeps' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rvdeps' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:893: UserWarning: The provided argument 'rcrimsg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcrimsg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:902: UserWarning: The provided argument 'rcrimss' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcrimss' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:911: UserWarning: The provided argument 'ricfrr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ricfrr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:920: UserWarning: The provided argument 'rrwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rrwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:929: UserWarning: The provided argument 'rcwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:938: UserWarning: The provided argument 'rcdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:947: UserWarning: The provided argument 'rrdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rrdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:956: UserWarning: The provided argument 'rcberi' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcberi' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:965: UserWarning: The provided argument 'rrevav' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rrevav' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:974: UserWarning: The provided argument 'rraccss' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rraccss' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:983: UserWarning: The provided argument 'rraccsg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rraccsg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:992: UserWarning: The provided argument 'rgmltr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rgmltr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1001: UserWarning: The provided argument 'rcautr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcautr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1010: UserWarning: The provided argument 'rcaccr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcaccr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1019: UserWarning: The provided argument 'rcmltsr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rcmltsr' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1028: UserWarning: The provided argument 'rrcfrig' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rrcfrig' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1037: UserWarning: The provided argument 'riaggs' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'riaggs' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1046: UserWarning: The provided argument 'riauts' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'riauts' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1055: UserWarning: The provided argument 'ridryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ridryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1064: UserWarning: The provided argument 'riwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'riwetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1073: UserWarning: The provided argument 'ricfrrg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'ricfrrg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1082: UserWarning: The provided argument 'rsrimcg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rsrimcg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1091: UserWarning: The provided argument 'rsaccrg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rsaccrg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1100: UserWarning: The provided argument 'rsmltg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rsmltg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1109: UserWarning: The provided argument 'rsdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rsdryg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1118: UserWarning: The provided argument 'rswetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rswetg' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
  /home/maurinl/maurinl26/dwarf-p-ice3/mode_ice4_tendencies/__init__.py:1127: UserWarning: The provided argument 'rwetgh' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).
    warnings.warn("The provided argument 'rwetgh' was not an f_contiguous NumPy array of type 'ctypes.c_float' (or equivalent). Automatically converting (probably creating a full copy).")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_derived_fields
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_increment_update
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_nucleation_post_processing
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rimltc_post_processing
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_rrhong_post_processing
FAILED tests/repro/test_ice4_tendencies.py::TestIce4Tendencies::test_ice4_total_tendencies_update
============ 6 failed, 1 passed, 120 warnings in 119.64s (0:01:59) =============
